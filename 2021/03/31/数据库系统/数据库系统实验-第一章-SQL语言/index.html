<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>数据库系统实验-第一章-SQL语言 | LeoK77</title><meta name="keywords" content="数据库系统,数据库系统实验"><meta name="author" content="LeoK77,17560376405@163.com"><meta name="copyright" content="LeoK77"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="数据库系统&#x2F;数据库系统实验-第一章-SQL语言">
<meta property="og:type" content="article">
<meta property="og:title" content="数据库系统实验-第一章-SQL语言">
<meta property="og:url" content="https://www.leok77.cn/2021/03/31/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/index.html">
<meta property="og:site_name" content="LeoK77">
<meta property="og:description" content="数据库系统&#x2F;数据库系统实验-第一章-SQL语言">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.leok77.cn/img/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C%E6%8C%87%E5%AF%BC%E6%95%99%E7%A8%8B.png">
<meta property="article:published_time" content="2021-03-31T04:16:56.000Z">
<meta property="article:modified_time" content="2021-04-14T01:43:02.000Z">
<meta property="article:author" content="LeoK77">
<meta property="article:tag" content="数据库系统">
<meta property="article:tag" content="数据库系统实验">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.leok77.cn/img/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C%E6%8C%87%E5%AF%BC%E6%95%99%E7%A8%8B.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://www.leok77.cn/2021/03/31/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '数据库系统实验-第一章-SQL语言',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-04-14 09:43:02'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">17</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">LeoK77</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">数据库系统实验-第一章-SQL语言</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-03-31T04:16:56.000Z" title="发表于 2021-03-31 12:16:56">2021-03-31</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-04-14T01:43:02.000Z" title="更新于 2021-04-14 09:43:02">2021-04-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/">数据库系统</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">10.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>42分钟</span></span></div></div></div><article class="post-content" id="article-container"><blockquote>
<p>内容来自2021春季学期《数据库系统》课程的实验要求，具体来自《数据库系统实验指导教程(第二版)》</p>
<p>本片文章中使用的是SQL Server配合DataGrip，仅对DataGrip做一些基础使用的介绍，不赘述SQL Server安装过程</p>
</blockquote>
<h2 id="配置DataGrip"><a href="#配置DataGrip" class="headerlink" title="配置DataGrip"></a>配置DataGrip</h2><blockquote>
<p>这里介绍的是如何使用DataGrip连接SQL Server，而且DataGrip是一款付费软件(可以通过学生认证白嫖使用权)，如果使用的是SSMS连接SQL Server，那么可以直接跳过这部分</p>
</blockquote>
<h3 id="什么是DataGrip"><a href="#什么是DataGrip" class="headerlink" title="什么是DataGrip"></a>什么是DataGrip</h3><p>DataGrip是JetBrains公司为数据库开发的一款IDE，一开始其相应功能仅是作为大名鼎鼎的IDEA的插件，后来独立成为了一款IDE，理论上来说完全可以通过为IDEA添加插件来实现相应功能，但是我喜欢一款IDE仅做一方面的工作，所以我还是安装了DataGrip，既然是JetBrains公司出品的，那么补全功能就是他们的一贯作风，我是离不开自动补全了，顺别贴一下我使用的软件(红框中的都是JetBrains公司出品的)：</p>
<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210331122521.png" alt="image-20210331122521597"></p>
<p>安装DataGrip有两种方法，一种是下载安装包安装，一种是使用JetBrains ToolBox安装，因为我使用学生认证白嫖了JetBrains全家桶，所以我使用JetBrains ToolBox进行相应的管理，这里不做安装过程的展示。</p>
<blockquote>
<p>DataGrip：<a target="_blank" rel="noopener" href="https://www.jetbrains.com/datagrip/">https://www.jetbrains.com/datagrip/</a><br>JetBrains ToolBox：<a target="_blank" rel="noopener" href="https://www.jetbrains.com/toolbox-app/">https://www.jetbrains.com/toolbox-app/</a></p>
</blockquote>
<h3 id="开启SQL-Server的TCP-IP协议"><a href="#开启SQL-Server的TCP-IP协议" class="headerlink" title="开启SQL Server的TCP/IP协议"></a>开启SQL Server的TCP/IP协议</h3><blockquote>
<p>使用DataGrip连接SQL Server需要其开启TCP/IP功能，因为DataGrip不同于SSMS，并不属于官方工具，需要通过TCP/IP连接</p>
</blockquote>
<p>打开SQL Server 2019 配置管理器(如果严格按照老师的要求应该是安装2016)，可以在开始菜单中找到，也可以通过”Win+Q”搜索找到，比如：</p>
<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210331123557.png" alt="image-20210331123557040"></p>
<p>然后依次点开”SQL Server网络配置”-&gt;”MSSQLSERVER的协议”-&gt;”TCP/IP”</p>
<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210331124748.png" alt="image-20210331124748076"></p>
<p>然后依次点开”SQL Server服务”-&gt;”SQL Server(MSSQLSERVER)”重启</p>
<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210331125117.png" alt="image-20210331125117364"></p>
<h3 id="DataGrip连接SQL-Server"><a href="#DataGrip连接SQL-Server" class="headerlink" title="DataGrip连接SQL Server"></a>DataGrip连接SQL Server</h3><p>依次点击”File”-&gt;”New”-&gt;”Data Source”-&gt;”Microsoft SQL Server”(SQL Server在Data Source中的顺序不一定与我的一致，因为我已经添加过了，开头第一个不是的话往下翻看找找)</p>
<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210331125305.png" alt="image-20210331125305269"></p>
<p>然后填写信息即可，这里做一下简单的介绍：</p>
<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210331130122.png" alt="image-20210331130121845"></p>
<p>Test Connection成功示例：</p>
<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210331130154.png" alt="image-20210331130154139"></p>
<p>DataGrip主窗口，布局介绍大致如下：</p>
<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210331154813.png" alt="image-20210331154813362"></p>
<p>很多内容默认是不列出的，比如SQL Server数据库的默认SCHEMA是dbo，但是上述新建的TEST数据库中列出的SCHEMA居然一个也没有，这时候就需要手动使dboSCHEMA可见：</p>
<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210331155144.png" alt="image-20210331155144823"></p>
<p>这样新建表或者对表进行操作之后，表的信息就可以在左侧看到了。</p>
<h2 id="实验1-1——数据定义"><a href="#实验1-1——数据定义" class="headerlink" title="实验1.1——数据定义"></a>实验1.1——数据定义</h2><blockquote>
<p>实验目的：熟悉SQL的数据定义语言，能够熟练地使用SQL语句来创建和更改基本表，创建和取消索引</p>
</blockquote>
<h3 id="实验内容"><a href="#实验内容" class="headerlink" title="实验内容"></a>实验内容</h3><ul>
<li>使用CREATE语句创建基本表</li>
<li>更改基本表的定义，增加列，删除列，修改列的数据类型</li>
<li>创建表的升降序索引</li>
<li>取消表、表的索引或表的约束</li>
</ul>
<h3 id="实验步骤"><a href="#实验步骤" class="headerlink" title="实验步骤"></a>实验步骤</h3><p>(1)使用SQL语句创建关系数据库表：人员表PERSON(P#, Pname, Page, Pgender)，房间表ROOM(R#, Rname, Rarea)，表P-R(P#, R#, Date)。其中P#是表PERSON的主键，具有唯一性约束，Page具有约束：大于18；R#是表ROOM的主键，具有唯一性约束；表P-R中的P#，R#是外键。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> PERSON</span><br><span class="line">(</span><br><span class="line">    P#    <span class="type">CHAR</span>(<span class="number">8</span>)  <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">UNIQUE</span>,</span><br><span class="line">    Pname <span class="type">CHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    Page  <span class="type">INT</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> <span class="keyword">KEY</span> (P#),</span><br><span class="line">    <span class="keyword">CHECK</span> (Page <span class="operator">&gt;</span> <span class="number">18</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> ROOM</span><br><span class="line">(</span><br><span class="line">    R#    <span class="type">CHAR</span>(<span class="number">8</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">UNIQUE</span>,</span><br><span class="line">    Rname <span class="type">CHAR</span>(<span class="number">20</span>),</span><br><span class="line">    Rarea <span class="type">FLOAT</span>(<span class="number">10</span>),</span><br><span class="line">    <span class="keyword">PRIMARY</span> <span class="keyword">KEY</span> (R#)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> PR</span><br><span class="line">(</span><br><span class="line">    P#   <span class="type">CHAR</span>(<span class="number">8</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">UNIQUE</span>,</span><br><span class="line">    R#   <span class="type">CHAR</span>(<span class="number">8</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">UNIQUE</span>,</span><br><span class="line">    <span class="type">Date</span> DATETIME,</span><br><span class="line">    <span class="keyword">PRIMARY</span> <span class="keyword">KEY</span> (P#, R#),</span><br><span class="line"><span class="comment">--     FOREIGN KEY (P#) REFERENCES PERSON ON DELETE CASCADE,</span></span><br><span class="line"><span class="comment">--     FOREIGN KEY (R#) REFERENCES ROOM ON DELETE CASCADE</span></span><br><span class="line">    <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (P#) <span class="keyword">REFERENCES</span> PERSON,</span><br><span class="line">    <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (R#) <span class="keyword">REFERENCES</span> ROOM</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210331161736.png" alt="image-20210331161736235"></p>
<p>(2)更改表PERSON，增加属性Rtype(类型是CHAR，长度为10)，取消Page大于18的约束。把表ROOM中的属性Rname的数据类型改为长度是30。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> PERSON</span><br><span class="line">    <span class="keyword">ADD</span> Ptype <span class="type">CHAR</span>(<span class="number">10</span>);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> PERSON</span><br><span class="line">    <span class="keyword">DROP</span> <span class="keyword">CONSTRAINT</span> CK__PERSON__Page__25869641;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> ROOM</span><br><span class="line">    <span class="keyword">ALTER</span> <span class="keyword">COLUMN</span> Rname <span class="type">CHAR</span>(<span class="number">30</span>);</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210331161948.png" alt="image-20210331161948051"></p>
<p>(3)删除表ROOM的一个属性Rarea。<br>(4)取消表PR。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> ROOM</span><br><span class="line">    <span class="keyword">DROP</span> <span class="keyword">COLUMN</span> Rarea;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> PR;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210331162029.png" alt="image-20210331162029687"></p>
<p>(5)为ROOM表创建按R#降序排列的索引。<br>(6)为PERSON表创建按P#升序排列的索引。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> INDEX ROOMINDEX <span class="keyword">ON</span> ROOM (R# <span class="keyword">DESC</span>);</span><br><span class="line"><span class="keyword">CREATE</span> INDEX PERSONINDEX <span class="keyword">ON</span> PERSON (P# <span class="keyword">ASC</span>);</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210331162131.png" alt="image-20210331162131025"></p>
<p>(7)创建表PERSON的按Pname升序排列的唯一性索引。<br>(8)取消PERSON表P#升序索引。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">UNIQUE</span> INDEX PERSONUNIQUE <span class="keyword">ON</span> PERSON (Pname <span class="keyword">ASC</span>);</span><br><span class="line"><span class="keyword">DROP</span> INDEX PERSON.PERSONINDEX;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210331162235.png" alt="image-20210331162235807"></p>
<h3 id="自我实践"><a href="#自我实践" class="headerlink" title="自我实践"></a>自我实践</h3><p>(1)创建数据库表CUSTOMSERS(CID, CNAME, CITY, DISCNT)，数据库表AGENTS(AID, ANAME, CITY, PERCENT)，数据库表PRODUCTS(PID, PNAME)。其中CID，AID，PID分别是各表的主键，具有唯一性约束。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> CUSTOMSERS</span><br><span class="line">(</span><br><span class="line">    CID    <span class="type">CHAR</span>(<span class="number">8</span>)  <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">UNIQUE</span>,</span><br><span class="line">    CNAME  <span class="type">CHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    CITY   <span class="type">CHAR</span>(<span class="number">20</span>),</span><br><span class="line">    DISCNT <span class="type">INT</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> <span class="keyword">KEY</span> (CID)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> AGENTS</span><br><span class="line">(</span><br><span class="line">    AID       <span class="type">CHAR</span>(<span class="number">8</span>)  <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">UNIQUE</span>,</span><br><span class="line">    ANAME     <span class="type">CHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    CITY      <span class="type">CHAR</span>(<span class="number">20</span>),</span><br><span class="line">    [<span class="keyword">PERCENT</span>] <span class="type">INT</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> <span class="keyword">KEY</span> (AID)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> PRODUCTS</span><br><span class="line">(</span><br><span class="line">    PID   <span class="type">CHAR</span>(<span class="number">8</span>)  <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">UNIQUE</span>,</span><br><span class="line">    PNAME <span class="type">CHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> <span class="keyword">KEY</span> (PID)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210331170201.png" alt="image-20210331170201880"></p>
<p>(2)创建数据库表ORDERS(ORDNA, MONTH, CID, AID, PID, QTY, DOLLARS)。其中ORDNA是主键，具有唯一性约束；CID，AID，PID是外键，分别参照的是表CUSTOMSERS的CID字段，表AGENTS的AID字段，PRODUCTS的PID字段。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> ORDERS</span><br><span class="line">(</span><br><span class="line">    ORDNA   <span class="type">CHAR</span>(<span class="number">8</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">UNIQUE</span>,</span><br><span class="line">    <span class="keyword">MONTH</span>   <span class="type">INT</span>,</span><br><span class="line">    CID     <span class="type">CHAR</span>(<span class="number">8</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">UNIQUE</span>,</span><br><span class="line">    AID     <span class="type">CHAR</span>(<span class="number">8</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">UNIQUE</span>,</span><br><span class="line">    PID     <span class="type">CHAR</span>(<span class="number">8</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">UNIQUE</span>,</span><br><span class="line">    QTY     <span class="type">CHAR</span>(<span class="number">20</span>),</span><br><span class="line">    DOLLARS MONEY,</span><br><span class="line">    <span class="keyword">PRIMARY</span> <span class="keyword">KEY</span> (ORDNA),</span><br><span class="line">    <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (CID) <span class="keyword">REFERENCES</span> CUSTOMSERS (CID),</span><br><span class="line">    <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (AID) <span class="keyword">REFERENCES</span> AGENTS (AID),</span><br><span class="line">    <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (PID) <span class="keyword">REFERENCES</span> PRODUCTS (PID)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210331170241.png" alt="image-20210331170241663"></p>
<p>(3)增加数据库表PRODUCTS的三个属性列：CITY，QUANTITY，PRICE。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> PRODUCTS</span><br><span class="line">    <span class="keyword">ADD</span> CITY <span class="type">CHAR</span>(<span class="number">20</span>);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> PRODUCTS</span><br><span class="line">    <span class="keyword">ADD</span> QUANTITY <span class="type">INT</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> PRODUCTS</span><br><span class="line">    <span class="keyword">ADD</span> PRICE MONEY;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210331170327.png" alt="image-20210331170327361"></p>
<p>(4)为以上四个表建立各自的按主键增序排列的索引。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> INDEX CUSINDEX <span class="keyword">ON</span> CUSTOMSERS (CID);</span><br><span class="line"><span class="keyword">CREATE</span> INDEX AGENTSINDEX <span class="keyword">ON</span> AGENTS (AID);</span><br><span class="line"><span class="keyword">CREATE</span> INDEX PROINDEX <span class="keyword">ON</span> PRODUCTS (PID);</span><br><span class="line"><span class="keyword">CREATE</span> INDEX ORDERSINDEX <span class="keyword">ON</span> ORDERS (ORDNA);</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210331170414.png" alt="image-20210331170413980"></p>
<p>(5)取消步骤(4)建立的四个索引。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DROP</span> INDEX CUSTOMSERS.CUSINDEX;</span><br><span class="line"><span class="keyword">DROP</span> INDEX AGENTS.AGENTSINDEX;</span><br><span class="line"><span class="keyword">DROP</span> INDEX PRODUCTS.PROINDEX;</span><br><span class="line"><span class="keyword">DROP</span> INDEX ORDERS.ORDERSINDEX;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210331170535.png" alt="image-20210331170535101"></p>
<h2 id="实验1-2——数据查询"><a href="#实验1-2——数据查询" class="headerlink" title="实验1.2——数据查询"></a>实验1.2——数据查询</h2><blockquote>
<p>实验目的：熟悉SQL语句的数据查询语言，能够使用SQL语句对数据库进行单表查询、连接查询、嵌套查询、集合查询和统计查询。通过实验理解在数据库表中的对数据的NULL值的处理。</p>
</blockquote>
<h3 id="前期准备"><a href="#前期准备" class="headerlink" title="前期准备"></a>前期准备</h3><p>虽然直接写出SELECT语句也可以，但是为了直观的看出自己写的对不对，还是要先导入School数据库，一般情况下导入数据库时遇到的最多的问题就是“访问权限”问题，修改一下权限即可：</p>
<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210331172611.png" alt="image-20210331172611053"></p>
<p>在DataGrip的console或者SSMS的查询中执行如下语句：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">EXEC</span> sp_attach_db <span class="variable">@dbname</span> <span class="operator">=</span> <span class="string">&#x27;School&#x27;</span>,</span><br><span class="line">     <span class="variable">@filename1</span> <span class="operator">=</span> N<span class="string">&#x27;D:\Study\2021-Spring\数据库系统\Experiment\实验数据库\School_Data.MDF&#x27;</span>,</span><br><span class="line">     <span class="variable">@filename2</span> <span class="operator">=</span> N<span class="string">&#x27;D:\Study\2021-Spring\数据库系统\Experiment\实验数据库\School_Log.LDF&#x27;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>其中：<ul>
<li>dbname即数据库名称，可以自己改</li>
<li>filename1和filename2分别是mdf和ldf文件的路径，替换为自己的路径即可</li>
</ul>
</li>
</ul>
<p>如果使用的是DataGrip，可能还需要使导入的数据库可见，参照前面的”配置DataGrip”中的介绍即可。</p>
<h3 id="实验内容-1"><a href="#实验内容-1" class="headerlink" title="实验内容"></a>实验内容</h3><p>本节内容主要是对数据库进行查询操作，包括如下4类查询方式：</p>
<ol>
<li>单表查询<ul>
<li>查询的目标表达式为所有列、指定列或指定列的运算</li>
<li>使用DISTINCT保留字消除重复行</li>
<li>对查询结果排序和分组</li>
<li>集合分组使用集函数进行各项统计</li>
</ul>
</li>
<li>连接查询<ul>
<li>笛卡尔连接和等值连接</li>
<li>自连接</li>
<li>外连接</li>
<li>复合条件连接</li>
<li>多表连接</li>
</ul>
</li>
<li>嵌套查询<ul>
<li>通过实验验证对子查询的两个限制条件</li>
<li>体会相关子查询和不相关子查询的不同</li>
<li>考察4类谓词的用法，包括：<ul>
<li>第1类：IN，NOT IN</li>
<li>第2类：带有比较运算符的子查询</li>
<li>第3类：SOME, ANY或ALL谓词的子查询</li>
<li>第4类：带有EXISTS谓词的子查询</li>
</ul>
</li>
</ul>
</li>
<li>集合运算<ul>
<li>使用保留字UNION进行集合或运算</li>
<li>采用逻辑运算符AND或OR来实现集合交和减运算</li>
</ul>
</li>
</ol>
<h3 id="实验步骤-1"><a href="#实验步骤-1" class="headerlink" title="实验步骤"></a>实验步骤</h3><p>以School数据库为例，在该数据库中存在4张表格，分别为：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">STUDENTS(sid, sname, email, grade)</span><br><span class="line">TEACHERS(tid, tname, email, salary)</span><br><span class="line">COURSES(cid, cname, <span class="keyword">hour</span>)</span><br><span class="line">CHOICES(<span class="keyword">no</span>, sid, tid, cid, score)</span><br></pre></td></tr></table></figure>

<p>在数据库中，存在这样的关系：学生可以选择课程。一个课程对应一个教师。在表CHOICES中保存学生的选课记录</p>
<p>(1)查询年级为2001的所有学生的名称，按编号升序排列</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sname</span><br><span class="line"><span class="keyword">FROM</span> STUDENTS</span><br><span class="line"><span class="keyword">WHERE</span> grade <span class="operator">=</span> <span class="number">2001</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> sid;</span><br></pre></td></tr></table></figure>

<p>(2)查询学生的选课成绩合格的课程成绩，并把成绩换算为绩点(60分对应绩点为1，每增加1，绩点增加1)</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> score <span class="operator">-</span> <span class="number">60</span> <span class="operator">+</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> score <span class="operator">&gt;=</span> <span class="number">60</span>;</span><br><span class="line"><span class="comment">-- SELECT score - 59</span></span><br><span class="line"><span class="comment">-- FROM CHOICES</span></span><br><span class="line"><span class="comment">-- WHERE score &gt;= 60;</span></span><br></pre></td></tr></table></figure>

<p>(3)查询课时是48或64的课程的名称</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cname</span><br><span class="line"><span class="keyword">FROM</span> COURSES</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">hour</span> <span class="keyword">IN</span> (<span class="number">48</span>, <span class="number">64</span>);</span><br></pre></td></tr></table></figure>

<p>(4)查询所有课程名称中含有data的课程编号</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cid</span><br><span class="line"><span class="keyword">FROM</span> COURSES</span><br><span class="line"><span class="keyword">WHERE</span> cname <span class="keyword">LIKE</span> <span class="string">&#x27;%data%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>(5)查询所有选课记录的课程号(不重复显示)</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> cid</span><br><span class="line"><span class="keyword">FROM</span> CHOICES;</span><br></pre></td></tr></table></figure>

<p>(6)统计所有老师的平均工资</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary)</span><br><span class="line"><span class="keyword">FROM</span> TEACHERS;</span><br></pre></td></tr></table></figure>

<p>(7)查询所有学生的编号、姓名和平均成绩，按总平均成绩降序排列</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> STUDENTS.sid, sname, <span class="built_in">AVG</span>(score) <span class="string">&#x27;AVG-SCORE&#x27;</span></span><br><span class="line"><span class="keyword">FROM</span> STUDENTS,</span><br><span class="line">     CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> STUDENTS.sid <span class="operator">=</span> CHOICES.sid</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> STUDENTS.sid, sname</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">AVG</span>(score) <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<p>(8)统计各个课程的选课人数和平均成绩</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cid, <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> sid) <span class="string">&#x27;COUNT-PEOPLE&#x27;</span>, <span class="built_in">AVG</span>(score) <span class="string">&#x27;AVG-SCORE&#x27;</span></span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> cid;</span><br></pre></td></tr></table></figure>

<p>(9)查询至少选修了三门课程的学生编号</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sid</span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> sid</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> cid) <span class="operator">&gt;=</span> <span class="number">3</span>;</span><br></pre></td></tr></table></figure>

<p>(10)查询编号为800009026的学生所选的全部课程的课程名和成绩</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cname, score</span><br><span class="line"><span class="keyword">FROM</span> COURSES,</span><br><span class="line">     CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> COURSES.cid <span class="operator">=</span> CHOICES.cid</span><br><span class="line">  <span class="keyword">AND</span> CHOICES.sid <span class="operator">=</span> <span class="string">&#x27;800009026&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>(11)查询所有选了database的学生的编号</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sid</span><br><span class="line"><span class="keyword">FROM</span> COURSES,</span><br><span class="line">     CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> COURSES.cname <span class="operator">=</span> <span class="string">&#x27;database&#x27;</span></span><br><span class="line">  <span class="keyword">AND</span> COURSES.cid <span class="operator">=</span> CHOICES.cid;</span><br><span class="line"><span class="keyword">SELECT</span> sid</span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> cid <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> COURSES.cid</span><br><span class="line">    <span class="keyword">FROM</span> COURSES</span><br><span class="line">    <span class="keyword">WHERE</span> cname <span class="operator">=</span> <span class="string">&#x27;database&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>(12)求出选择了同一个课程的学生对</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> FIRST.sid, SECOND.sid</span><br><span class="line"><span class="keyword">FROM</span> CHOICES <span class="keyword">FIRST</span>,</span><br><span class="line">     CHOICES <span class="keyword">SECOND</span></span><br><span class="line"><span class="keyword">WHERE</span> FIRST.sid <span class="operator">!=</span> SECOND.sid</span><br><span class="line">  <span class="keyword">AND</span> FIRST.cid <span class="operator">=</span> SECOND.cid;</span><br></pre></td></tr></table></figure>

<p>(13)求出至少被两名学生选修的课程编号</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cid</span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> cid</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> sid) <span class="operator">&gt;=</span> <span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<p>(14)查询选修了编号为80009026的学生所选的某个课程的学生编号</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sid</span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> cid <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> cid</span><br><span class="line">    <span class="keyword">FROM</span> CHOICES</span><br><span class="line">    <span class="keyword">WHERE</span> sid <span class="operator">=</span> <span class="string">&#x27;800009026&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>(15)查询学生的基本信息及选修课程编号和成绩</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> STUDENTS.<span class="operator">*</span>, CHOICES.cid, CHOICES.score</span><br><span class="line"><span class="keyword">FROM</span> STUDENTS,</span><br><span class="line">     CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> STUDENTS.sid <span class="operator">=</span> CHOICES.sid</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> STUDENTS.sid, CHOICES.score <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<p>(16)查询学号850955252的学生的姓名和选修的课程名称及成绩</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sname, cname, score</span><br><span class="line"><span class="keyword">FROM</span> STUDENTS,</span><br><span class="line">     COURSES,</span><br><span class="line">     CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> STUDENTS.sid <span class="operator">=</span> <span class="string">&#x27;850955252&#x27;</span></span><br><span class="line">  <span class="keyword">AND</span> STUDENTS.sid <span class="operator">=</span> CHOICES.sid</span><br><span class="line">  <span class="keyword">AND</span> CHOICES.cid <span class="operator">=</span> COURSES.cid;</span><br></pre></td></tr></table></figure>

<p>(17)查询学号850955252的学生同年级的所有学生资料</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> STUDENTS</span><br><span class="line"><span class="keyword">WHERE</span> grade <span class="operator">=</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> grade</span><br><span class="line">    <span class="keyword">FROM</span> STUDENTS</span><br><span class="line">    <span class="keyword">WHERE</span> sid <span class="operator">=</span> <span class="string">&#x27;850955252&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>(18)查询所有的有选课的学生的详细信息</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> STUDENTS.<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> STUDENTS,</span><br><span class="line">     CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> CHOICES.sid <span class="operator">=</span> STUDENTS.sid;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> STUDENTS</span><br><span class="line"><span class="keyword">WHERE</span> sid <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> sid</span><br><span class="line">    <span class="keyword">FROM</span> CHOICES</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>(19)查询没有学生选的课程的编号</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cid</span><br><span class="line"><span class="keyword">FROM</span> COURSES</span><br><span class="line"><span class="keyword">WHERE</span> cid <span class="keyword">NOT</span> <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> cid</span><br><span class="line">    <span class="keyword">FROM</span> CHOICES</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>(20)查询选修了课程名为C++的学生学号和姓名</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sid, sname</span><br><span class="line"><span class="keyword">FROM</span> STUDENTS</span><br><span class="line"><span class="keyword">WHERE</span> sid <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> sid</span><br><span class="line">    <span class="keyword">FROM</span> CHOICES</span><br><span class="line">    <span class="keyword">WHERE</span> cid <span class="keyword">IN</span> (</span><br><span class="line">        <span class="keyword">SELECT</span> cid</span><br><span class="line">        <span class="keyword">FROM</span> COURSES</span><br><span class="line">        <span class="keyword">WHERE</span> cname <span class="operator">=</span> <span class="string">&#x27;c++&#x27;</span></span><br><span class="line">    )</span><br><span class="line">);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> STUDENTS.sid, STUDENTS.sname</span><br><span class="line"><span class="keyword">FROM</span> STUDENTS,</span><br><span class="line">     COURSES,</span><br><span class="line">     CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> STUDENTS.sid <span class="operator">=</span> CHOICES.sid</span><br><span class="line">  <span class="keyword">AND</span> COURSES.cname <span class="operator">=</span> <span class="string">&#x27;C++&#x27;</span></span><br><span class="line">  <span class="keyword">AND</span> COURSES.cid <span class="operator">=</span> CHOICES.cid;</span><br></pre></td></tr></table></figure>

<p>(21)找出选修课程成绩最差的选课记录</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> score <span class="operator">&lt;=</span> <span class="keyword">ALL</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> score</span><br><span class="line">    <span class="keyword">FROM</span> CHOICES</span><br><span class="line">    <span class="keyword">WHERE</span> score <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> score <span class="operator">=</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="built_in">MIN</span>(score)</span><br><span class="line">    <span class="keyword">FROM</span> CHOICES</span><br><span class="line">    <span class="keyword">WHERE</span> score <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>(22)找出和课程UML或课程C++的课时一样的课程名称</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cname</span><br><span class="line"><span class="keyword">FROM</span> COURSES</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">hour</span> <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">hour</span></span><br><span class="line">    <span class="keyword">FROM</span> COURSES</span><br><span class="line">    <span class="keyword">WHERE</span> cname <span class="operator">=</span> <span class="string">&#x27;UML&#x27;</span></span><br><span class="line">       <span class="keyword">OR</span> cname <span class="operator">=</span> <span class="string">&#x27;C++&#x27;</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">SELECT</span> FIRST.cname</span><br><span class="line"><span class="keyword">FROM</span> COURSES <span class="keyword">FIRST</span>,</span><br><span class="line">     COURSES <span class="keyword">SECOND</span></span><br><span class="line"><span class="keyword">WHERE</span> (SECOND.cname <span class="operator">=</span> <span class="string">&#x27;UML&#x27;</span> <span class="keyword">OR</span> SECOND.cname <span class="operator">=</span> <span class="string">&#x27;C++&#x27;</span>)</span><br><span class="line">  <span class="keyword">AND</span> FIRST.hour <span class="operator">=</span> SECOND.hour;</span><br></pre></td></tr></table></figure>

<p>(23)查询所有选修编号10001的课程的学生学号和姓名</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> STUDENTS.sid, STUDENTS.sname</span><br><span class="line"><span class="keyword">FROM</span> STUDENTS,</span><br><span class="line">     CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> STUDENTS.sid <span class="operator">=</span> CHOICES.sid</span><br><span class="line">  <span class="keyword">AND</span> CHOICES.cid <span class="operator">=</span> <span class="string">&#x27;10001&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>(24)查询选修了所有课程的学生姓名</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sname</span><br><span class="line"><span class="keyword">FROM</span> STUDENTS</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>(</span><br><span class="line">        <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">        <span class="keyword">FROM</span> COURSES</span><br><span class="line">        <span class="keyword">WHERE</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>(</span><br><span class="line">                <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">                <span class="keyword">FROM</span> CHOICES</span><br><span class="line">                <span class="keyword">WHERE</span> CHOICES.sid <span class="operator">=</span> STUDENTS.sid</span><br><span class="line">                  <span class="keyword">AND</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">            )</span><br><span class="line">    );</span><br></pre></td></tr></table></figure>

<p>(25)利用集合运算，查询选修课程C++或课程Java的学生的编号</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 使用集合运算——UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> sid</span><br><span class="line"><span class="keyword">FROM</span> CHOICES,</span><br><span class="line">     COURSES</span><br><span class="line"><span class="keyword">WHERE</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">  <span class="keyword">AND</span> COURSES.cname <span class="operator">=</span> <span class="string">&#x27;C++&#x27;</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> sid</span><br><span class="line"><span class="keyword">FROM</span> CHOICES,</span><br><span class="line">     COURSES</span><br><span class="line"><span class="keyword">WHERE</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">  <span class="keyword">AND</span> COURSES.cname <span class="operator">=</span> <span class="string">&#x27;JAVA&#x27;</span>;</span><br><span class="line"><span class="comment">-- 不使用集合运算</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> sid</span><br><span class="line"><span class="keyword">FROM</span> CHOICES,</span><br><span class="line">     COURSES</span><br><span class="line"><span class="keyword">WHERE</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">  <span class="keyword">AND</span> (COURSES.cname <span class="operator">=</span> <span class="string">&#x27;C++&#x27;</span> <span class="keyword">OR</span> COURSES.cname <span class="operator">=</span> <span class="string">&#x27;JAVA&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>(26)实现集合加运算，查询既选修课程C++又选修课程Java的学生的编号</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 使用集合加运算——INTERSECT</span></span><br><span class="line"><span class="keyword">SELECT</span> CHOICES.sid</span><br><span class="line"><span class="keyword">FROM</span> CHOICES,</span><br><span class="line">     COURSES</span><br><span class="line"><span class="keyword">WHERE</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">  <span class="keyword">AND</span> COURSES.cname <span class="operator">=</span> <span class="string">&#x27;C++&#x27;</span></span><br><span class="line"><span class="keyword">INTERSECT</span></span><br><span class="line"><span class="keyword">SELECT</span> CHOICES.sid</span><br><span class="line"><span class="keyword">FROM</span> CHOICES,</span><br><span class="line">     COURSES</span><br><span class="line"><span class="keyword">WHERE</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">  <span class="keyword">AND</span> COURSES.cname <span class="operator">=</span> <span class="string">&#x27;Java&#x27;</span>;</span><br><span class="line"><span class="comment">-- 不使用集合加运算</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> FIRST.sid</span><br><span class="line"><span class="keyword">FROM</span> CHOICES <span class="keyword">FIRST</span>,</span><br><span class="line">     CHOICES <span class="keyword">SECOND</span></span><br><span class="line"><span class="keyword">WHERE</span> FIRST.sid <span class="operator">=</span> SECOND.sid</span><br><span class="line">  <span class="keyword">AND</span> FIRST.cid <span class="operator">=</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> COURSES.cid</span><br><span class="line">    <span class="keyword">FROM</span> COURSES</span><br><span class="line">    <span class="keyword">WHERE</span> COURSES.cname <span class="operator">=</span> <span class="string">&#x27;C++&#x27;</span></span><br><span class="line">)</span><br><span class="line">  <span class="keyword">AND</span> SECOND.cid <span class="operator">=</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> COURSES.cid</span><br><span class="line">    <span class="keyword">FROM</span> COURSES</span><br><span class="line">    <span class="keyword">WHERE</span> COURSES.cname <span class="operator">=</span> <span class="string">&#x27;JAVA&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>(27)实现集合减运算，查询选修课程C++而没有选修课程Java的学生的编号</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 使用集合减运算——EXCEPT</span></span><br><span class="line"><span class="keyword">SELECT</span> sid</span><br><span class="line"><span class="keyword">FROM</span> CHOICES,</span><br><span class="line">     COURSES</span><br><span class="line"><span class="keyword">WHERE</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">  <span class="keyword">AND</span> COURSES.cname <span class="operator">=</span> <span class="string">&#x27;C++&#x27;</span></span><br><span class="line">    <span class="keyword">EXCEPT</span></span><br><span class="line"><span class="keyword">SELECT</span> sid</span><br><span class="line"><span class="keyword">FROM</span> CHOICES,</span><br><span class="line">     COURSES</span><br><span class="line"><span class="keyword">WHERE</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">  <span class="keyword">AND</span> COURSES.cname <span class="operator">=</span> <span class="string">&#x27;JAVA&#x27;</span>;</span><br><span class="line"><span class="comment">-- 不使用集合减运算</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> FIRST.sid</span><br><span class="line"><span class="keyword">FROM</span> CHOICES <span class="keyword">FIRST</span>,</span><br><span class="line">     CHOICES <span class="keyword">SECOND</span></span><br><span class="line"><span class="keyword">WHERE</span> FIRST.sid <span class="operator">=</span> SECOND.sid</span><br><span class="line">  <span class="keyword">AND</span> FIRST.cid <span class="operator">=</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> COURSES.cid</span><br><span class="line">    <span class="keyword">FROM</span> COURSES</span><br><span class="line">    <span class="keyword">WHERE</span> COURSES.cname <span class="operator">=</span> <span class="string">&#x27;C++&#x27;</span></span><br><span class="line">)</span><br><span class="line">  <span class="keyword">AND</span> SECOND.sid <span class="keyword">NOT</span> <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> sid</span><br><span class="line">    <span class="keyword">FROM</span> CHOICES,</span><br><span class="line">         COURSES</span><br><span class="line">    <span class="keyword">WHERE</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">      <span class="keyword">AND</span> COURSES.cname <span class="operator">=</span> <span class="string">&#x27;JAVA&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="自我实践-1"><a href="#自我实践-1" class="headerlink" title="自我实践"></a>自我实践</h3><p>(1)查询全部课程的详细记录</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> COURSES;</span><br></pre></td></tr></table></figure>

<p>(2)查询所有有选修课的学生的编号</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> sid</span><br><span class="line"><span class="keyword">FROM</span> CHOICES;</span><br></pre></td></tr></table></figure>

<p>(3)查询课时&lt;88小时的课程的编号</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cid</span><br><span class="line"><span class="keyword">FROM</span> COURSES</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">hour</span> <span class="operator">&lt;</span> <span class="number">88</span>;</span><br></pre></td></tr></table></figure>

<p>(4)请找出总分超过400分的学生</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sid</span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> sid</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">SUM</span>(score) <span class="operator">&gt;</span> <span class="number">400</span>;</span><br></pre></td></tr></table></figure>

<p>(5)查询课程的总数</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line"><span class="keyword">FROM</span> COURSES;</span><br></pre></td></tr></table></figure>

<p>(6)查询所有课程和选修该课程的学生总数</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> COURSES.<span class="operator">*</span>, <span class="built_in">COUNT</span>(sid) <span class="string">&#x27;COUNT-SID&#x27;</span></span><br><span class="line"><span class="keyword">FROM</span> COURSES,</span><br><span class="line">     CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> COURSES.cid <span class="operator">=</span> CHOICES.cid</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> COURSES.cid, cname, <span class="keyword">hour</span>;</span><br></pre></td></tr></table></figure>

<p>(7)查询选修成绩合格的课程超过两门的学生的编号</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sid</span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> score <span class="operator">&gt;=</span> <span class="number">60</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> sid</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(cid) <span class="operator">&gt;</span> <span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<p>(8)统计各个学生的选修课程数目和平均成绩</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sid, <span class="built_in">COUNT</span>(cid) <span class="string">&#x27;COUNT-CID&#x27;</span>, <span class="built_in">AVG</span>(score) <span class="string">&#x27;AVG-SCORE&#x27;</span></span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> CHOICES.sid;</span><br></pre></td></tr></table></figure>

<p>(9)查询选修Java的所有学生的编号及姓名</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> STUDENTS.sid, STUDENTS.sname</span><br><span class="line"><span class="keyword">FROM</span> CHOICES,</span><br><span class="line">     COURSES,</span><br><span class="line">     STUDENTS</span><br><span class="line"><span class="keyword">WHERE</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">  <span class="keyword">AND</span> CHOICES.sid <span class="operator">=</span> STUDENTS.sid</span><br><span class="line">  <span class="keyword">AND</span> COURSES.cname <span class="operator">=</span> <span class="string">&#x27;JAVA&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>(10)分别使用等值连接和谓词IN两种方式查询姓名为sssht的学生所选的课程的编号和成绩</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cid, score</span><br><span class="line"><span class="keyword">FROM</span> CHOICES,</span><br><span class="line">     STUDENTS</span><br><span class="line"><span class="keyword">WHERE</span> CHOICES.sid <span class="operator">=</span> STUDENTS.sid</span><br><span class="line">  <span class="keyword">AND</span> sname <span class="operator">=</span> <span class="string">&#x27;sssht&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> cid, score</span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> CHOICES.sid <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> sid</span><br><span class="line">    <span class="keyword">FROM</span> STUDENTS</span><br><span class="line">    <span class="keyword">WHERE</span> sname <span class="operator">=</span> <span class="string">&#x27;sssht&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>(11)查询其他课时比课程C++多的课程的名称</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cname</span><br><span class="line"><span class="keyword">FROM</span> COURSES</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">hour</span> <span class="operator">&gt;</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">hour</span></span><br><span class="line">    <span class="keyword">FROM</span> COURSES</span><br><span class="line">    <span class="keyword">WHERE</span> cname <span class="operator">=</span> <span class="string">&#x27;C++&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>(12)查询选修C++课程的成绩比姓名为znkoo的学生高的所有学生的编号和姓名</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> STUDENTS.sid, STUDENTS.sname</span><br><span class="line"><span class="keyword">FROM</span> STUDENTS,</span><br><span class="line">     CHOICES,</span><br><span class="line">     COURSES</span><br><span class="line"><span class="keyword">WHERE</span> STUDENTS.sid <span class="operator">=</span> CHOICES.sid</span><br><span class="line">  <span class="keyword">AND</span> COURSES.cid <span class="operator">=</span> CHOICES.cid</span><br><span class="line">  <span class="keyword">AND</span> COURSES.cname <span class="operator">=</span> <span class="string">&#x27;C++&#x27;</span></span><br><span class="line">  <span class="keyword">AND</span> CHOICES.score <span class="operator">&gt;</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> score</span><br><span class="line">    <span class="keyword">FROM</span> STUDENTS,</span><br><span class="line">         CHOICES,</span><br><span class="line">         COURSES</span><br><span class="line">    <span class="keyword">WHERE</span> STUDENTS.sname <span class="operator">=</span> <span class="string">&#x27;znkoo&#x27;</span></span><br><span class="line">      <span class="keyword">AND</span> STUDENTS.sid <span class="operator">=</span> CHOICES.sid</span><br><span class="line">      <span class="keyword">AND</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">      <span class="keyword">AND</span> COURSES.cname <span class="operator">=</span> <span class="string">&#x27;C++&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>(13)找出和学生883794999或学生8509555252的年级一样的学生的姓名</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sname</span><br><span class="line"><span class="keyword">FROM</span> STUDENTS</span><br><span class="line"><span class="keyword">WHERE</span> grade <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> grade</span><br><span class="line">    <span class="keyword">FROM</span> STUDENTS</span><br><span class="line">    <span class="keyword">WHERE</span> sid <span class="operator">=</span> <span class="string">&#x27;883794999&#x27;</span></span><br><span class="line">       <span class="keyword">OR</span> sid <span class="operator">=</span> <span class="string">&#x27;8509555252&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>(14)查询没有选修Java的学生名称</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sname</span><br><span class="line"><span class="keyword">FROM</span> STUDENTS</span><br><span class="line"><span class="keyword">WHERE</span> sid <span class="keyword">NOT</span> <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> sid</span><br><span class="line">    <span class="keyword">FROM</span> CHOICES,</span><br><span class="line">         COURSES</span><br><span class="line">    <span class="keyword">WHERE</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">      <span class="keyword">AND</span> COURSES.cname <span class="operator">=</span> <span class="string">&#x27;JAVA&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>(15)找出课时最少的课程的详细信息</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> COURSES</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">hour</span> <span class="operator">&lt;=</span> <span class="keyword">ALL</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">hour</span></span><br><span class="line">    <span class="keyword">FROM</span> COURSES</span><br><span class="line">);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> COURSES</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">hour</span> <span class="operator">=</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="built_in">MIN</span>(<span class="keyword">hour</span>)</span><br><span class="line">    <span class="keyword">FROM</span> COURSES</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>(16)查询工资最高的教师的编号和开设的课程号</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> CHOICES.tid, CHOICES.cid</span><br><span class="line"><span class="keyword">FROM</span> CHOICES,</span><br><span class="line">     TEACHERS</span><br><span class="line"><span class="keyword">WHERE</span> CHOICES.tid <span class="operator">=</span> TEACHERS.tid</span><br><span class="line">  <span class="keyword">AND</span> TEACHERS.salary <span class="operator">=</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="built_in">MAX</span>(salary)</span><br><span class="line">    <span class="keyword">FROM</span> TEACHERS</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>(17)找出选修课程ERP成绩最高的学生编号</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sid</span><br><span class="line"><span class="keyword">FROM</span> CHOICES,</span><br><span class="line">     COURSES</span><br><span class="line"><span class="keyword">WHERE</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">  <span class="keyword">AND</span> COURSES.cname <span class="operator">=</span> <span class="string">&#x27;ERP&#x27;</span></span><br><span class="line">  <span class="keyword">AND</span> score <span class="operator">=</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="built_in">MAX</span>(score)</span><br><span class="line">    <span class="keyword">FROM</span> CHOICES,</span><br><span class="line">         COURSES</span><br><span class="line">    <span class="keyword">WHERE</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">      <span class="keyword">AND</span> COURSES.cname <span class="operator">=</span> <span class="string">&#x27;ERP&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>(18)查询没有学生选修的课程的名称</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cname</span><br><span class="line"><span class="keyword">FROM</span> COURSES</span><br><span class="line"><span class="keyword">WHERE</span> cid <span class="keyword">NOT</span> <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> cid</span><br><span class="line">    <span class="keyword">FROM</span> CHOICES</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>(19)找出讲授课程UML的教师讲授的所有课程名称</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> cname</span><br><span class="line"><span class="keyword">FROM</span> CHOICES,</span><br><span class="line">     COURSES</span><br><span class="line"><span class="keyword">WHERE</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">  <span class="keyword">AND</span> tid <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> tid</span><br><span class="line">    <span class="keyword">FROM</span> CHOICES,</span><br><span class="line">         COURSES</span><br><span class="line">    <span class="keyword">WHERE</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">      <span class="keyword">AND</span> COURSES.cname <span class="operator">=</span> <span class="string">&#x27;UML&#x27;</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>(20)查询选修了编号200102901的教师开设的所有课程的学生编号</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> sid</span><br><span class="line"><span class="keyword">FROM</span> CHOICES X</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>(</span><br><span class="line">        <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">        <span class="keyword">FROM</span> CHOICES Y</span><br><span class="line">        <span class="keyword">WHERE</span> Y.tid <span class="operator">=</span> <span class="string">&#x27;200102901&#x27;</span></span><br><span class="line">          <span class="keyword">AND</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>(</span><br><span class="line">                <span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">                <span class="keyword">FROM</span> CHOICES Z</span><br><span class="line">                <span class="keyword">WHERE</span> Z.sid <span class="operator">=</span> X.sid</span><br><span class="line">                  <span class="keyword">AND</span> Z.cid <span class="operator">=</span> Y.cid</span><br><span class="line">            )</span><br><span class="line">    );</span><br></pre></td></tr></table></figure>

<p>(21)查询选修课程Database的学生集合与选修课程UML的学生集合的并集</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sid</span><br><span class="line"><span class="keyword">FROM</span> CHOICES,</span><br><span class="line">     COURSES</span><br><span class="line"><span class="keyword">WHERE</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">  <span class="keyword">AND</span> COURSES.cname <span class="operator">=</span> <span class="string">&#x27;Database&#x27;</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> sid</span><br><span class="line"><span class="keyword">FROM</span> CHOICES,</span><br><span class="line">     COURSES</span><br><span class="line"><span class="keyword">WHERE</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">  <span class="keyword">AND</span> COURSES.cname <span class="operator">=</span> <span class="string">&#x27;UML&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>(22)实现集合交运算，查询既选修课程Database又选修课程UML的学生的编号</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sid</span><br><span class="line"><span class="keyword">FROM</span> CHOICES,</span><br><span class="line">     COURSES</span><br><span class="line"><span class="keyword">WHERE</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">  <span class="keyword">AND</span> COURSES.cname <span class="operator">=</span> <span class="string">&#x27;Database&#x27;</span></span><br><span class="line"><span class="keyword">INTERSECT</span></span><br><span class="line"><span class="keyword">SELECT</span> sid</span><br><span class="line"><span class="keyword">FROM</span> CHOICES,</span><br><span class="line">     COURSES</span><br><span class="line"><span class="keyword">WHERE</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">  <span class="keyword">AND</span> COURSES.cname <span class="operator">=</span> <span class="string">&#x27;UML&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>(23)实现集合减运算，查询选修课程Database而没有选修课程UML的学生的编号</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sid</span><br><span class="line"><span class="keyword">FROM</span> CHOICES,</span><br><span class="line">     COURSES</span><br><span class="line"><span class="keyword">WHERE</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">  <span class="keyword">AND</span> COURSES.cname <span class="operator">=</span> <span class="string">&#x27;Database&#x27;</span></span><br><span class="line">    <span class="keyword">EXCEPT</span></span><br><span class="line"><span class="keyword">SELECT</span> sid</span><br><span class="line"><span class="keyword">FROM</span> CHOICES,</span><br><span class="line">     COURSES</span><br><span class="line"><span class="keyword">WHERE</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">  <span class="keyword">AND</span> COURSES.cname <span class="operator">=</span> <span class="string">&#x27;UML&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h2 id="实验1-3——数据更新"><a href="#实验1-3——数据更新" class="headerlink" title="实验1.3——数据更新"></a>实验1.3——数据更新</h2><blockquote>
<p>实验目的：熟悉数据库的数据更新操作，能够使用SQL语句对数据库进程数据的插入、更新、删除操作</p>
</blockquote>
<h3 id="实验内容-2"><a href="#实验内容-2" class="headerlink" title="实验内容"></a>实验内容</h3><p>本次实验中，主要内容是如何使用SQL语句对数据进行更新：</p>
<ul>
<li>使用INSERT INTO语句插入数据，包括插入一个元组或将子查询的结果插入到数据库中两种方式</li>
<li>使用SELECT INTO语句，产生一个新表并插入数据</li>
<li>使用UPDATE语句可以修改指定表中满足WHERE子句条件的元组，有三种修改的方式：修改一个元组，修改多个元组的值，带子查询的修改语句</li>
<li>使用DELETE语句删除数据：删除某一个元组的值，删除多个元组的值，带子查询的删除语句</li>
</ul>
<h3 id="实验步骤-2"><a href="#实验步骤-2" class="headerlink" title="实验步骤"></a>实验步骤</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">USE School;</span><br></pre></td></tr></table></figure>

<p>(1)使用SQL语句向STUDENTS表中插入元组<br>– (编号：700045678；名字：LiMing；EMAIL：<a href="mailto:&#76;&#x58;&#64;&#99;&#x64;&#101;&#x6d;&#103;&#46;&#99;&#x6f;&#x6d;">&#76;&#x58;&#64;&#99;&#x64;&#101;&#x6d;&#103;&#46;&#99;&#x6f;&#x6d;</a>；年级：1992</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span></span><br><span class="line"><span class="keyword">INTO</span> STUDENTS(SID, SNAME, EMAIL, GRADE)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;700045678&#x27;</span>, <span class="string">&#x27;LiMing&#x27;</span>, <span class="string">&#x27;LX@cdemg.com&#x27;</span>, <span class="number">1992</span>);</span><br><span class="line"><span class="comment">-- 查询插入前和插入后的区别</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> STUDENTS</span><br><span class="line"><span class="keyword">WHERE</span> sid <span class="operator">=</span> <span class="string">&#x27;700045678&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210405094124.png" alt="image-20210405094123962"></p>
<p>(2)对每个课程，求学生的选课人数和学生的平均成绩，并把结果存入数据库。<br>– 使用SELECT INTO和INSERT INTO两种方法实现</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 第一步，建表——COURSEINFO_INSERT</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> COURSEINFO_INSERT</span><br><span class="line">(</span><br><span class="line">    Cid       <span class="type">CHAR</span>(<span class="number">10</span>),</span><br><span class="line">    Students  <span class="type">INT</span>,</span><br><span class="line">    Avg_score <span class="type">SMALLINT</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 第二步，使用INSERT INTO的方式</span></span><br><span class="line"><span class="keyword">INSERT</span></span><br><span class="line"><span class="keyword">INTO</span> COURSEINFO_INSERT(CID, STUDENTS, AVG_SCORE)</span><br><span class="line"><span class="keyword">SELECT</span> cid, <span class="built_in">COUNT</span>(sid), <span class="built_in">AVG</span>(score)</span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> cid;</span><br><span class="line"><span class="comment">-- 查询插入结果</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> COURSEINFO_INSERT;</span><br><span class="line"><span class="comment">-- 使用SELECT INTO的方式</span></span><br><span class="line"><span class="keyword">SELECT</span> cid        <span class="keyword">AS</span> Cid,</span><br><span class="line">       <span class="built_in">COUNT</span>(sid) <span class="keyword">AS</span> Students,</span><br><span class="line">       <span class="built_in">AVG</span>(score) <span class="keyword">AS</span> Avg_score</span><br><span class="line"><span class="keyword">INTO</span> COURSEINFO_SELECT</span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> cid;</span><br><span class="line"><span class="comment">-- 查询插入结果</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> COURSEINFO_SELECT;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210405100406.png" alt="image-20210405100405951"></p>
<p>(3)在STUDENTS表中使用SQL语句将姓名为”LiMing”的学生的年级改为”2002”</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> STUDENTS</span><br><span class="line"><span class="keyword">SET</span> grade<span class="operator">=</span><span class="number">2002</span></span><br><span class="line"><span class="keyword">WHERE</span> sname <span class="operator">=</span> <span class="string">&#x27;LiMing&#x27;</span>;</span><br><span class="line"><span class="comment">-- 查询更新前和更新后的对比</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> STUDENTS</span><br><span class="line"><span class="keyword">WHERE</span> sname <span class="operator">=</span> <span class="string">&#x27;LiMing&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210405100739.png" alt="image-20210405100739228"></p>
<p>(4)在TEACHERS表中使用SQL语句将所有教师的工资多加500元</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> TEACHERS</span><br><span class="line"><span class="keyword">SET</span> salary<span class="operator">=</span>salary <span class="operator">+</span> <span class="number">500</span>;</span><br><span class="line"><span class="comment">-- 查询更新前和更新后的对比</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> TEACHERS;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210405101503.png" alt="image-20210405101503520"></p>
<p>(5)将姓名为zapyv的学生的课程”C”的成绩加上5分</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> CHOICES</span><br><span class="line"><span class="keyword">SET</span> score<span class="operator">=</span>score <span class="operator">+</span> <span class="number">5</span></span><br><span class="line"><span class="keyword">WHERE</span> sid <span class="operator">=</span> (<span class="keyword">SELECT</span> sid <span class="keyword">FROM</span> STUDENTS <span class="keyword">WHERE</span> sname <span class="operator">=</span> <span class="string">&#x27;zapyv&#x27;</span>)</span><br><span class="line">  <span class="keyword">AND</span> cid <span class="operator">=</span> (<span class="keyword">SELECT</span> Cid <span class="keyword">FROM</span> COURSES <span class="keyword">WHERE</span> cname <span class="operator">=</span> <span class="string">&#x27;c&#x27;</span>);</span><br><span class="line"><span class="comment">-- 查询更新前和更新后的对比</span></span><br><span class="line"><span class="keyword">SELECT</span> STUDENTS.sid, sname, COURSES.Cid, cname, score</span><br><span class="line"><span class="keyword">FROM</span> STUDENTS,</span><br><span class="line">     COURSES,</span><br><span class="line">     CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> STUDENTS.sid <span class="operator">=</span> CHOICES.sid</span><br><span class="line">  <span class="keyword">AND</span> COURSES.cid <span class="operator">=</span> CHOICES.cid</span><br><span class="line">  <span class="keyword">AND</span> sname <span class="operator">=</span> <span class="string">&#x27;zapyv&#x27;</span></span><br><span class="line">  <span class="keyword">AND</span> cname <span class="operator">=</span> <span class="string">&#x27;c&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210405102339.png" alt="image-20210405102339558"></p>
<p>(6)在STUDENTS表中使用SQL语句删除姓名为”LiMing”的学生信息</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DELETE</span></span><br><span class="line"><span class="keyword">FROM</span> STUDENTS</span><br><span class="line"><span class="keyword">WHERE</span> sname <span class="operator">=</span> <span class="string">&#x27;LiMing&#x27;</span>;</span><br><span class="line"><span class="comment">-- 查询删除前和删除后的对比</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> STUDENTS</span><br><span class="line"><span class="keyword">WHERE</span> sname <span class="operator">=</span> <span class="string">&#x27;LiMing&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210405102512.png" alt="image-20210405102512765"></p>
<p>(7)删除所有选修课程”Java”的选课记录</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DELETE</span></span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> cid <span class="operator">=</span> (<span class="keyword">SELECT</span> cid</span><br><span class="line">             <span class="keyword">FROM</span> COURSES</span><br><span class="line">             <span class="keyword">WHERE</span> cname <span class="operator">=</span> <span class="string">&#x27;Java&#x27;</span>);</span><br><span class="line"><span class="comment">-- 查询删除前和删除后的对比</span></span><br><span class="line"><span class="keyword">SELECT</span> CHOICES.<span class="operator">*</span>, cname</span><br><span class="line"><span class="keyword">FROM</span> CHOICES,</span><br><span class="line">     COURSES</span><br><span class="line"><span class="keyword">WHERE</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">  <span class="keyword">AND</span> cname <span class="operator">=</span> <span class="string">&#x27;Java&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210405102943.png" alt="image-20210405102943220"></p>
<p>(8)对COURSES表做删去时间&lt;48的元组的操作，并讨论该删除操作所受到的约束</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DELETE</span></span><br><span class="line"><span class="keyword">FROM</span> COURSES</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">hour</span> <span class="operator">&lt;</span> <span class="number">48</span>;</span><br><span class="line"><span class="comment">-- 查询删除前和删除后的对比</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> COURSES</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">hour</span> <span class="operator">&lt;</span> <span class="number">48</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[2021-04-05 10:31:39] [23000][547] DELETE 语句与 REFERENCE 约束&quot;FK_CHOICES_COURSES&quot;冲突。该冲突发生于数据库&quot;School&quot;，表&quot;dbo.CHOICES&quot;, column &#39;cid&#39;。</span><br></pre></td></tr></table></figure>

<p>因为COURSES中的cid在CHOICES表中作为外键存在，所以与约束冲突，删除失败</p>
<h3 id="自我实践-2"><a href="#自我实践-2" class="headerlink" title="自我实践"></a>自我实践</h3><p>(1)向STUDENTS表中插入编号是’800022222’且姓名是”WangLan”的元组</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span></span><br><span class="line"><span class="keyword">INTO</span> STUDENTS(sid, sname)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;800022222&#x27;</span>, <span class="string">&#x27;WangLan&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>(2)向TEACHERS表插入元组(‘200001000’, ‘LXL’, ‘s4zrck@pew.net’, ‘3024’)</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span></span><br><span class="line"><span class="keyword">INTO</span> TEACHERS(TID, TNAME, EMAIL, SALARY)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;200001000&#x27;</span>, <span class="string">&#x27;LXL&#x27;</span>, <span class="string">&#x27;s4zrck@pew.net&#x27;</span>, <span class="string">&#x27;3024&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>(3)将TEACHERS表中编号为’200010493’的老师的工资改为4000</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> TEACHERS</span><br><span class="line"><span class="keyword">SET</span> salary<span class="operator">=</span><span class="number">4000</span></span><br><span class="line"><span class="keyword">WHERE</span> tid <span class="operator">=</span> <span class="string">&#x27;200010493&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>(4)将TEACHERS表中所有工资小于2500的老师工资改为2500</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> TEACHERS</span><br><span class="line"><span class="keyword">SET</span> salary<span class="operator">=</span><span class="number">2500</span></span><br><span class="line"><span class="keyword">WHERE</span> salary <span class="operator">&lt;</span> <span class="number">2500</span>;</span><br></pre></td></tr></table></figure>

<p>(5)将由编号为’200016731’的老师所授的课程全部改为由姓名为’rnupx’的老师讲授</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> CHOICES</span><br><span class="line"><span class="keyword">SET</span> tid<span class="operator">=</span>(<span class="keyword">SELECT</span> tid <span class="keyword">FROM</span> TEACHERS <span class="keyword">WHERE</span> tname <span class="operator">=</span> <span class="string">&#x27;rnupx&#x27;</span>)</span><br><span class="line"><span class="keyword">WHERE</span> tid <span class="operator">=</span> <span class="string">&#x27;200016731&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>(6)更新编号为’800071780’的学生年级为2001</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> STUDENTS</span><br><span class="line"><span class="keyword">SET</span> grade<span class="operator">=</span><span class="number">2001</span></span><br><span class="line"><span class="keyword">WHERE</span> sid <span class="operator">=</span> <span class="string">&#x27;800071780&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>(7)删除没有学生选修的课程</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DELETE</span></span><br><span class="line"><span class="keyword">FROM</span> COURSES</span><br><span class="line"><span class="keyword">WHERE</span> cid <span class="keyword">NOT</span> <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> Cid</span><br><span class="line">    <span class="keyword">FROM</span> CHOICES</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>(8)删除年级高于1998的学生信息</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DELETE</span></span><br><span class="line"><span class="keyword">FROM</span> STUDENTS</span><br><span class="line"><span class="keyword">WHERE</span> grade <span class="operator">&lt;</span> <span class="number">1998</span>;</span><br></pre></td></tr></table></figure>

<p>(9)删除没有选修课程的学生信息</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DELETE</span></span><br><span class="line"><span class="keyword">FROM</span> STUDENTS</span><br><span class="line"><span class="keyword">WHERE</span> sid <span class="keyword">NOT</span> <span class="keyword">IN</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> sid</span><br><span class="line">    <span class="keyword">FROM</span> CHOICES</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>(10)删除成绩不及格的选课记录</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DELETE</span></span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> score <span class="operator">&lt;</span> <span class="number">60</span>;</span><br></pre></td></tr></table></figure>

<h2 id="实验1-4——视图"><a href="#实验1-4——视图" class="headerlink" title="实验1.4——视图"></a>实验1.4——视图</h2><blockquote>
<p>实验目的：熟悉SQL语言支持的有关视图的操作，能够熟练使用SQL语句来创建需要的视图，对视图进行查询和取消视图</p>
</blockquote>
<h3 id="实验内容-3"><a href="#实验内容-3" class="headerlink" title="实验内容"></a>实验内容</h3><ol>
<li>定义常见的视图形式，包括：<ul>
<li>行列子集视图</li>
<li>WITH CHECK OPTION视图</li>
<li>基于多个基表的视图</li>
<li>基于视图的视图</li>
<li>带表达式的视图</li>
<li>分组视图</li>
</ul>
</li>
<li>通过实验考察WITH CHECK OPTION这一语句在视图定义后产生的影响，包括对修改操作、删除操作、插入操作的影响</li>
<li>讨论视图的数据更新情况，对子行列视图进行数据更新</li>
<li>使用DROP语句删除一个视图，由该视图导出的其他视图定义仍在数据字典中，但已不能使用，必须显式删除。同样的原因，删除基表时，由该基表导出的所有视图定义都必须显式删除</li>
</ol>
<h3 id="实验步骤-3"><a href="#实验步骤-3" class="headerlink" title="实验步骤"></a>实验步骤</h3><p>(1)创建一个行列子集视图，给出选课成绩合格的学生的编号，所选课程号和该课程成绩</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> Qualified</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> sid, cid, score</span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> score <span class="operator">&gt;=</span> <span class="number">60</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210414083446.png" alt="image-20210414083445992"></p>
<p>(2)创建基于多个基表的视图，这个视图由学生姓名和其所选修的课程名及讲授该课程的教师姓名构成</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> SCT</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> sname, cname, tname</span><br><span class="line"><span class="keyword">FROM</span> STUDENTS,</span><br><span class="line">     COURSES,</span><br><span class="line">     TEACHERS,</span><br><span class="line">     CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> STUDENTS.sid <span class="operator">=</span> CHOICES.sid</span><br><span class="line">  <span class="keyword">AND</span> COURSES.cid <span class="operator">=</span> CHOICES.cid</span><br><span class="line">  <span class="keyword">AND</span> TEACHERS.tid <span class="operator">=</span> CHOICES.tid;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210414083327.png" alt="image-20210414083327445"></p>
<p>(3)创建带表达式的视图，由学生姓名、所选课程名和所有课程成绩都比原来多5分这几个属性组成</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> ExpressionVIEW</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> sname, cname, score <span class="operator">+</span> <span class="number">5</span> <span class="keyword">AS</span> SCORE</span><br><span class="line"><span class="keyword">FROM</span> STUDENTS,</span><br><span class="line">     COURSES,</span><br><span class="line">     CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> STUDENTS.sid <span class="operator">=</span> CHOICES.sid</span><br><span class="line">  <span class="keyword">AND</span> COURSES.cid <span class="operator">=</span> CHOICES.cid</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210414083748.png" alt="image-20210414083748742"></p>
<p>(4)创建分组视图，将学生的学号及其平均成绩定义为一个视图</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> GroupingVIEW</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> sid, <span class="built_in">AVG</span>(score) <span class="keyword">AS</span> Avg_score</span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> sid;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210414083843.png" alt="image-20210414083842937"></p>
<p>(5)创建一个基于视图的视图，基于(1)中建立的视图，定义一个包含学生编号，学生所选课数目和平均成绩的视图</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> BASEDONVIWE</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> sid,</span><br><span class="line">       <span class="built_in">COUNT</span>(cid) <span class="keyword">AS</span> Count_cid,</span><br><span class="line">       <span class="built_in">AVG</span>(score) <span class="keyword">AS</span> Avg_score</span><br><span class="line"><span class="keyword">FROM</span> Qualified</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> sid;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210414083950.png" alt="image-20210414083950141"></p>
<p>(6)查询所有选修课程Software Engineering的学生姓名</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sname</span><br><span class="line"><span class="keyword">FROM</span> SCT</span><br><span class="line"><span class="keyword">WHERE</span> cname <span class="operator">=</span> <span class="string">&#x27;Software Engineering&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210414084014.png" alt="image-20210414084014100"></p>
<p>(7)插入元组(600000000, 823069829, 10010, 59)到视图CS中<br>– 若是在视图的定义中存在WITH CHECK OPTION子句对插入操作有什么影响</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> CS</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">no</span>, sid, cid, score</span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> score <span class="operator">&gt;=</span> <span class="number">60</span></span><br><span class="line"><span class="keyword">WITH</span> <span class="keyword">CHECK</span> OPTION;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> CS(<span class="keyword">NO</span>, SID, CID, SCORE)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;600000000&#x27;</span>, <span class="string">&#x27;823069829&#x27;</span>, <span class="string">&#x27;10010&#x27;</span>, <span class="number">59</span>);</span><br></pre></td></tr></table></figure>

<p>含有WITH CHECK OPTION会进行检查，由于待插入元组的Score为59不及格，故插入失败</p>
<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210414090019.png" alt="image-20210414084124700"></p>
<p>(8)将视图CS(包含WITH CHECK OPTION)中，所有课程编号为10010的课程的成绩都减去5分。<br>– 这个操作数据库是否会正确执行，为什么？<br>– 如果加上5分(原来95分以上的不变)呢？</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> CS</span><br><span class="line"><span class="keyword">SET</span> score<span class="operator">=</span>score <span class="operator">-</span> <span class="number">5</span>;</span><br></pre></td></tr></table></figure>

<p>减去5分的操作不会正确执行，因为CS具有WITH CHECK OPTION检查，部分元组减去5分后会检查出错，不再及格</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> CS</span><br><span class="line"><span class="keyword">SET</span> score<span class="operator">=</span>score <span class="operator">+</span> <span class="number">5</span></span><br><span class="line"><span class="keyword">WHERE</span> score <span class="operator">&lt;=</span> <span class="number">95</span>;</span><br></pre></td></tr></table></figure>

<p>增加5分可以正确执行，因为增加5分这项操作不会触碰WITH CHECK OPTION的检查</p>
<p>(9)在视图CS(包含WITH CHECK OPTION)中，删除编号为804529880学生的记录，会产生什么结果</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DELETE</span></span><br><span class="line"><span class="keyword">FROM</span> CS</span><br><span class="line"><span class="keyword">WHERE</span> sid <span class="operator">=</span> <span class="string">&#x27;804529880&#x27;</span>;</span><br><span class="line"><span class="comment">-- 由于视图不保存数据内容，而是保存类似于“索引”的东西，所以删除操作是作用在原本的CHOICES表中，即在CHOICES表中，学号为804529880的学生的选课记录均会被删除</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> sid <span class="operator">=</span> <span class="string">&#x27;804529880&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>(10)取消视图SCT和视图CS</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> SCT;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> CS;</span><br><span class="line"><span class="comment">-- 自己定义的第(1)中的名字是Qualified(及格)，相当于CS，而BASEDONVIEW视图基于此视图，需要显式删除</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> Qualified;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> BASEDONVIWE;</span><br><span class="line"><span class="comment">-- 顺便删除其他的视图</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> ExpressionVIEW;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> GroupingVIEW;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210414084215.png" alt="image-20210414084215852"></p>
<h3 id="自我实践-3"><a href="#自我实践-3" class="headerlink" title="自我实践"></a>自我实践</h3><p>(1)定义选课信息和课程名称的视图VIEWC</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> VIEWC</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> CHOICES.<span class="operator">*</span>, cname</span><br><span class="line"><span class="keyword">FROM</span> CHOICES,</span><br><span class="line">     COURSES</span><br><span class="line"><span class="keyword">WHERE</span> CHOICES.cid <span class="operator">=</span> COURSES.cid;</span><br></pre></td></tr></table></figure>

<p>(2)定义学生姓名和选课信息的视图VIEWS</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 不知道为啥，VIEWS报错，需要加[VIEWS]</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> [VIEWS]</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> sname, CHOICES.<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> STUDENTS,</span><br><span class="line">     CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> STUDENTS.sid <span class="operator">=</span> CHOICES.sid;</span><br></pre></td></tr></table></figure>

<p>(3)定义年级低于1998的学生的视图S1(SID, SNANE, GRADE)</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> S1(SID, SNAME, GRADE)</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> sid, sname, grade</span><br><span class="line"><span class="keyword">FROM</span> STUDENTS</span><br><span class="line"><span class="keyword">WHERE</span> grade <span class="operator">&gt;</span> <span class="number">1998</span></span><br><span class="line"><span class="keyword">WITH</span> <span class="keyword">CHECK</span> OPTION;</span><br></pre></td></tr></table></figure>

<p>(4)查询姓名为”uxjof”的学生的选课信息</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> [VIEWS]</span><br><span class="line"><span class="keyword">WHERE</span> sname <span class="operator">=</span> <span class="string">&#x27;uxjof&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>(5)查询选修课程”UML”的学生的编号和成绩</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sid, score</span><br><span class="line"><span class="keyword">FROM</span> VIEWC</span><br><span class="line"><span class="keyword">WHERE</span> cname <span class="operator">=</span> <span class="string">&#x27;UML&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>(6)向视图S1插入记录(‘60000001’, ‘Lily’, 2001)</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> S1(SID, SNAME, GRADE)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;60000001&#x27;</span>, <span class="string">&#x27;Lily&#x27;</span>, <span class="number">2001</span>);</span><br></pre></td></tr></table></figure>

<p>(7)定义包括更新和插入约束的视图S1，尝试向视图插入记录(‘60000001’, ‘Lily’, 1997)<br>– 删除所有年级为1999的学生记录，讨论更新和插入约束带来的影响</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> S1(SID, SNAME, GRADE)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;60000001&#x27;</span>, <span class="string">&#x27;Lily&#x27;</span>, <span class="number">1997</span>);</span><br><span class="line"><span class="comment">-- 因为已经在(6)中插入过学号为&#x27;60000001&#x27;的信息，由于UNIQUE约束，无法插入</span></span><br><span class="line"><span class="comment">-- 去除原本的学号为&#x27;60000001&#x27;的元组信息后，由于WITH CHECK OPTION约束，1997年级比1998高，无法插入</span></span><br><span class="line"><span class="keyword">DELETE</span></span><br><span class="line"><span class="keyword">FROM</span> S1</span><br><span class="line"><span class="keyword">WHERE</span> GRADE <span class="operator">=</span> <span class="number">1999</span>;</span><br><span class="line"><span class="comment">-- 删除失败，且由于视图的性质，删除操作针对的是原表STUDENTS，而STUDENTS中sid是表CHOICES的外键，发生REFERENCE冲突</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> STUDENTS</span><br><span class="line"><span class="keyword">WHERE</span> grade <span class="operator">=</span> <span class="number">1999</span>;</span><br></pre></td></tr></table></figure>

<p>(8)在视图VIEWS中将姓名为’uxjof’的学生的选课成绩都加上5分</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> [VIEWS]</span><br><span class="line"><span class="keyword">SET</span> score<span class="operator">=</span>score <span class="operator">+</span> <span class="number">5</span></span><br><span class="line"><span class="keyword">WHERE</span> sname <span class="operator">=</span> <span class="string">&#x27;uxjof&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> [VIEWS]</span><br><span class="line"><span class="keyword">WHERE</span> sname <span class="operator">=</span> <span class="string">&#x27;uxjof&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>(9)取消以上建立的所有视图</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> [VIEWS];</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> VIEWC;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> S1;</span><br></pre></td></tr></table></figure>

<h2 id="实验1-5——数据控制"><a href="#实验1-5——数据控制" class="headerlink" title="实验1.5——数据控制"></a>实验1.5——数据控制</h2><blockquote>
<p>实验目的：熟悉SQL的数据控制功能，能够使用SQL语句来向用户授予和回收权限</p>
</blockquote>
<h3 id="实验内容-4"><a href="#实验内容-4" class="headerlink" title="实验内容"></a>实验内容</h3><ol>
<li>使用GRANT语句对用户授权，对单个用户和多个用户授权，或使用保留字PUBLIC对所有用户授权。对不同的操作对象包括数据库、视图、基本表等进行不同权限的授权</li>
<li>使用WITH GRANT OPTION子句授予用户传播该权限的权利</li>
<li>在授权时发生循环授权，考察DBS能否发现这个错误。如果不能，结合取消权限操作，查看DBS对循环授权的控制</li>
<li>使用REVOKE子句收回授权，取消授权的级联反应</li>
</ol>
<h3 id="实验步骤-4"><a href="#实验步骤-4" class="headerlink" title="实验步骤"></a>实验步骤</h3><p>在数据库school中建立三个用户USER1，USER2和USER3，它们在数据库中的角色是PUBLIC。按以下要求，分别以管理员身份或这三个用户的身份登录到数据库中，进行操作</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> USER1 <span class="keyword">WITHOUT</span> LOGIN;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> USER2 <span class="keyword">WITHOUT</span> LOGIN;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> USER3 <span class="keyword">WITHOUT</span> LOGIN;</span><br><span class="line"><span class="comment">-- 一些基础语句：</span></span><br><span class="line"><span class="comment">-- 1.查看所有用户</span></span><br><span class="line"><span class="keyword">exec</span> sp_helpuser;</span><br><span class="line"><span class="comment">-- 2.切换到指定用户</span></span><br><span class="line"><span class="keyword">EXECUTE</span> <span class="keyword">AS</span> <span class="keyword">USER</span> <span class="operator">=</span><span class="string">&#x27;USER1&#x27;</span>;</span><br><span class="line"><span class="comment">-- 3.切换回数据库管理员-REVERT-好像是撤销指令</span></span><br><span class="line">REVERT;</span><br><span class="line"><span class="comment">-- 4.查看当前用户名</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">USER</span>;</span><br><span class="line"><span class="keyword">SELECT</span> SUSER_NAME();</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210414084430.png" alt="image-20210414084429943"></p>
<p>(1)授予所有用户对表COURSES的查询权限</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="keyword">ON</span> COURSES</span><br><span class="line">    <span class="keyword">TO</span> [PUBLIC];</span><br></pre></td></tr></table></figure>

<p>(2)授予USER1对表STUDENTS插入和更新的权限，但不授予删除权限，并且授予USER1传播这两个权限的权利</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">INSERT</span>, <span class="keyword">UPDATE</span></span><br><span class="line">    <span class="keyword">ON</span> STUDENTS</span><br><span class="line">    <span class="keyword">TO</span> USER1</span><br><span class="line">    <span class="keyword">WITH</span> <span class="keyword">GRANT</span> OPTION;</span><br></pre></td></tr></table></figure>

<p>(3)允许USER2在表CHOICES中插入元组，更新SCORE列，可以选取除了SID以外的所有列</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">INSERT</span>, <span class="comment">/* 在CHOICES中插入元组 */</span></span><br><span class="line">    <span class="keyword">UPDATE</span> (score) <span class="comment">/* 在CHOICES中更新SCORE列 */</span></span><br><span class="line">    <span class="keyword">ON</span> CHOICES</span><br><span class="line">    <span class="keyword">TO</span> USER2;</span><br><span class="line"><span class="comment">-- 创建视图，此视图仅没有sid</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> CHOICE_NO_SID(<span class="keyword">no</span>, cid, tid, score)</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">no</span>, cid, tid, score</span><br><span class="line"><span class="keyword">FROM</span> CHOICES;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span> <span class="comment">/* 对USER2授予查询上述新建的视图的权限 */</span></span><br><span class="line">    <span class="keyword">ON</span> CHOICE_NO_SID</span><br><span class="line">    <span class="keyword">TO</span> USER2;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210414085128.png" alt="image-20210414085128273"></p>
<p>(4)USER1授予USER2对表STUDENTS插入和更新的权限，并且授予USER2传播插入操作的权利</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">EXECUTE</span> <span class="keyword">AS</span> <span class="keyword">USER</span> <span class="operator">=</span><span class="string">&#x27;USER1&#x27;</span>; <span class="comment">/* 切换为USER1 */</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">USER</span>;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">UPDATE</span> <span class="comment">/* 对USER2授予更新STUDENTS的权限，不可传播 */</span></span><br><span class="line">    <span class="keyword">ON</span> STUDENTS</span><br><span class="line">    <span class="keyword">TO</span> USER2;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">INSERT</span> <span class="comment">/* 对USER2授予插入STUDENTS的权限，可传播 */</span></span><br><span class="line">    <span class="keyword">ON</span> STUDENTS</span><br><span class="line">    <span class="keyword">TO</span> USER2</span><br><span class="line">    <span class="keyword">WITH</span> <span class="keyword">GRANT</span> OPTION;</span><br></pre></td></tr></table></figure>

<p>(5)收回USER1对表COURSES查询的授权</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">REVERT; <span class="comment">/* 回到超级用户 */</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">USER</span>;</span><br><span class="line"><span class="keyword">REVOKE</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="keyword">ON</span> COURSES</span><br><span class="line">    <span class="keyword">FROM</span> USER1;</span><br></pre></td></tr></table></figure>

<p>(6)由上面(2)和(4)的授权，再由USER2对USER3授予表STUDENTS插入和更新的权限，并且授予USER3传播插入操作的权利。<br>– 这时候，如果由USER3对USER1授予表STUDENTS的插入和更新权限是否能够成功？<br>– 如果能够成功，那么如果由USER2取消对USER3的授权，对USER1会有什么影响？<br>– 如果再由DBA取消USER1的权限，对USER2有什么影响？</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">EXECUTE</span> <span class="keyword">AS</span> <span class="keyword">USER</span> <span class="operator">=</span><span class="string">&#x27;USER2&#x27;</span>; <span class="comment">/* 切换为USER2 */</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">USER</span>;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">UPDATE</span> <span class="comment">/* USER2不具有更新SUTDENTS的权限，授权失败 */</span></span><br><span class="line">    <span class="keyword">ON</span> STUDENTS</span><br><span class="line">    <span class="keyword">TO</span> USER3;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">INSERT</span> <span class="comment">/* USER3给USER1授予STUDENTS的插入权限成功 */</span></span><br><span class="line">    <span class="keyword">ON</span> STUDENTS</span><br><span class="line">    <span class="keyword">TO</span> USER3</span><br><span class="line">    <span class="keyword">WITH</span> <span class="keyword">GRANT</span> OPTION;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 这时候，如果由USER3对USER1授予表STUDENTS的插入和更新权限是否能够成功？</span></span><br><span class="line">REVERT; <span class="comment">/* 回到超级用户 */</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">USER</span>;</span><br><span class="line"><span class="keyword">EXECUTE</span> <span class="keyword">AS</span> <span class="keyword">USER</span> <span class="operator">=</span><span class="string">&#x27;USER3&#x27;</span>; <span class="comment">/* 切换为USER3 */</span></span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">UPDATE</span> <span class="comment">/* USER3不具有更新SUTDENTS的权限 */</span></span><br><span class="line">    <span class="keyword">ON</span> STUDENTS</span><br><span class="line">    <span class="keyword">TO</span> USER1;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">INSERT</span></span><br><span class="line">    <span class="keyword">ON</span> STUDENTS</span><br><span class="line">    <span class="keyword">TO</span> USER1;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 如果能够成功，那么如果由USER2取消对USER3的授权，对USER1会有什么影响？</span></span><br><span class="line">REVERT; <span class="comment">/* 回到超级用户 */</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">USER</span>;</span><br><span class="line"><span class="keyword">EXECUTE</span> <span class="keyword">AS</span> <span class="keyword">USER</span> <span class="operator">=</span><span class="string">&#x27;USER2&#x27;</span>; <span class="comment">/* 切换为USER2 */</span></span><br><span class="line"><span class="keyword">REVOKE</span> <span class="keyword">INSERT</span> <span class="comment">/* 取消对USER3的授权 */</span></span><br><span class="line">    <span class="keyword">ON</span> STUDENTS</span><br><span class="line">    <span class="keyword">FROM</span> USER3 CASCADE;</span><br><span class="line">REVERT; <span class="comment">/* 回到超级用户 */</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">USER</span>;</span><br><span class="line"><span class="keyword">EXECUTE</span> <span class="keyword">AS</span> <span class="keyword">USER</span> <span class="operator">=</span><span class="string">&#x27;USER1&#x27;</span>; <span class="comment">/* 切换为USER1 */</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> STUDENTS (SID, SNAME, EMAIL, GRADE) <span class="comment">/* 测试INSERT */</span></span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;TEST-USER1&#x27;</span>, <span class="string">&#x27;TEST&#x27;</span>, <span class="string">&#x27;TEST&#x27;</span>, <span class="number">2021</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> STUDENTS</span><br><span class="line"><span class="keyword">WHERE</span> sid <span class="operator">=</span> <span class="string">&#x27;TEST-USER1&#x27;</span>; <span class="comment">/* 插入成功，并不会影响USER1 */</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210414085700.png" alt="image-20210414085700166"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- 如果再由DBA取消USER1的权限，对USER2有什么影响？</span></span><br><span class="line">REVERT; <span class="comment">/* 回到超级用户 */</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">USER</span>;</span><br><span class="line"><span class="keyword">REVOKE</span> <span class="keyword">INSERT</span> , <span class="keyword">UPDATE</span> <span class="comment">/* 取消对USER1的授权 */</span></span><br><span class="line">    <span class="keyword">ON</span> STUDENTS</span><br><span class="line">    <span class="keyword">FROM</span> USER1 CASCADE;</span><br><span class="line"><span class="keyword">EXECUTE</span> <span class="keyword">AS</span> <span class="keyword">USER</span> <span class="operator">=</span><span class="string">&#x27;USER2&#x27;</span>; <span class="comment">/* 切换为USER2 */</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> STUDENTS (SID, SNAME, EMAIL, GRADE) <span class="comment">/* 测试INSERT */</span></span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;TEST-USER2&#x27;</span>, <span class="string">&#x27;TEST&#x27;</span>, <span class="string">&#x27;TEST&#x27;</span>, <span class="number">2021</span>);</span><br><span class="line"><span class="comment">-- USER2也不再具有对STUDENTS的插入权限</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210414085806.png" alt="image-20210414085806673"></p>
<h3 id="自我实践-4"><a href="#自我实践-4" class="headerlink" title="自我实践"></a>自我实践</h3><p>(1)授予所有用户对表STUDENTS的查询权限</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="keyword">ON</span> STUDENTS</span><br><span class="line">    <span class="keyword">TO</span> [PUBLIC];</span><br></pre></td></tr></table></figure>

<p>(2)授予所有用户对表COURSES的查询和更新权限</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span>, <span class="keyword">UPDATE</span></span><br><span class="line">    <span class="keyword">ON</span> COURSES</span><br><span class="line">    <span class="keyword">TO</span> [PUBLIC];</span><br></pre></td></tr></table></figure>

<p>(3)授予USER1对表TEACHERS的查询，更新工资的权限，且允许USER1可以传播这些权限</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span>, <span class="keyword">UPDATE</span> (salary)</span><br><span class="line">    <span class="keyword">ON</span> TEACHERS</span><br><span class="line">    <span class="keyword">TO</span> USER1</span><br><span class="line">    <span class="keyword">WITH</span> <span class="keyword">GRANT</span> OPTION;</span><br></pre></td></tr></table></figure>

<p>(4)授予USER2对表CHOICES的查询，更新成绩的权限</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span>, <span class="keyword">UPDATE</span> (score)</span><br><span class="line">    <span class="keyword">ON</span> CHOICES</span><br><span class="line">    <span class="keyword">TO</span> USER2;</span><br></pre></td></tr></table></figure>

<p>(5)授予USER2对表TEACHERS的除了工资以外的所有信息的查询权限</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> TEACHERS_NO_SALARY(TID, TNAME, EMAIL)</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> tid, tname, email</span><br><span class="line"><span class="keyword">FROM</span> TEACHERS;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="keyword">ON</span> TEACHERS_NO_SALARY</span><br><span class="line">    <span class="keyword">TO</span> USER2;</span><br></pre></td></tr></table></figure>

<p>(6)由USER1授予USER2对表TEACHERS的查询权限和传播此项权限的权利</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">EXECUTE</span> <span class="keyword">AS</span> <span class="keyword">USER</span> <span class="operator">=</span><span class="string">&#x27;USER1&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">USER</span>;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="keyword">ON</span> TEACHERS</span><br><span class="line">    <span class="keyword">TO</span> USER2</span><br><span class="line">    <span class="keyword">WITH</span> <span class="keyword">GRANT</span> OPTION;</span><br></pre></td></tr></table></figure>

<p>(7)由USER2授予USER3对表TEACHERS的查询权限和传播此项权限的权利。<br>– 再由USER3授予USER2上述权限，这样的SQL语句能否成功得到执行</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">REVERT;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">USER</span>;</span><br><span class="line"><span class="keyword">EXECUTE</span> <span class="keyword">AS</span> <span class="keyword">USER</span> <span class="operator">=</span><span class="string">&#x27;USER2&#x27;</span>;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="keyword">ON</span> TEACHERS</span><br><span class="line">    <span class="keyword">TO</span> USER3</span><br><span class="line">    <span class="keyword">WITH</span> <span class="keyword">GRANT</span> OPTION;</span><br><span class="line"><span class="comment">-- 再由USER3授予USER2上述权限，可以执行</span></span><br><span class="line">REVERT;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">USER</span>;</span><br><span class="line"><span class="keyword">EXECUTE</span> <span class="keyword">AS</span> <span class="keyword">USER</span> <span class="operator">=</span><span class="string">&#x27;USER3&#x27;</span>;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="keyword">ON</span> TEACHERS</span><br><span class="line">    <span class="keyword">TO</span> USER2</span><br><span class="line">    <span class="keyword">WITH</span> <span class="keyword">GRANT</span> OPTION;</span><br></pre></td></tr></table></figure>

<p>(8)取消USER1对表STUDENTS的查询权限，考虑由USER2的身份对表STUDENTS进行查询，操作能否成功？为什么？</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">REVERT;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">USER</span>;</span><br><span class="line"><span class="keyword">REVOKE</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="keyword">ON</span> STUDENTS</span><br><span class="line">    <span class="keyword">FROM</span> USER1 CASCADE;</span><br><span class="line"><span class="keyword">EXECUTE</span> <span class="keyword">AS</span> <span class="keyword">USER</span> <span class="operator">=</span><span class="string">&#x27;USER2&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> STUDENTS;</span><br><span class="line"><span class="comment">-- 操作可以成功，因为对表STUDENTS的查询权限是授予所有用户的，用户之间此权限无相关性</span></span><br></pre></td></tr></table></figure>

<p>题目应该改为——取消USER1对表TEACHERS的查询权限，考虑由USER2的身份对表TEACHERS进行查询，操作能否成功？为什么？</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">REVERT;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">USER</span>;</span><br><span class="line"><span class="keyword">REVOKE</span> <span class="keyword">SELECT</span></span><br><span class="line">    <span class="keyword">ON</span> TEACHERS</span><br><span class="line">    <span class="keyword">FROM</span> USER1 CASCADE;</span><br><span class="line"><span class="keyword">EXECUTE</span> <span class="keyword">AS</span> <span class="keyword">USER</span> <span class="operator">=</span><span class="string">&#x27;USER2&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> TEACHERS;</span><br><span class="line"><span class="comment">-- 此时操作不成功，因为权限被级联删除，USER2的对TEACHERS表的查询权限是由USER1授予的，回收USER1的权限的时候，USER2的权限被自动回收</span></span><br></pre></td></tr></table></figure>

<p>(9)取消USER1和USER2的关于COURSES的权限</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">REVERT;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">USER</span>;</span><br><span class="line"><span class="keyword">REVOKE</span> <span class="keyword">ALL</span> PRIVILEGES</span><br><span class="line">    <span class="keyword">ON</span> COURSES</span><br><span class="line">    <span class="keyword">FROM</span> USER1, USER2;</span><br></pre></td></tr></table></figure>

<h2 id="实验1-6——空值和空集的处理"><a href="#实验1-6——空值和空集的处理" class="headerlink" title="实验1.6——空值和空集的处理"></a>实验1.6——空值和空集的处理</h2><blockquote>
<p>实验目的：认识NULL值在数据库中的特殊含义，了解空值和空集对于数据库的数据查询操作，特别是空值在条件表达式中与其他的算术运算符或者逻辑运算符的运算中，空集作为嵌套查询的子查询的返回结果时候的特殊性，能够熟练使用SQL语句来进行与空值、空集相关的操作</p>
</blockquote>
<h3 id="实验内容-5"><a href="#实验内容-5" class="headerlink" title="实验内容"></a>实验内容</h3><p>通过实验验证在SQL Server对NULL的处理，包括：</p>
<ol>
<li>再查询的目标表达式中包含空值的运算</li>
<li>在查询条件中控制与比较运算符的运算结果</li>
<li>使用”IS NULL”和”IS NOT NULL”来判断元组该列是否为空值</li>
<li>对存在取空值的列按值进行ORDER BY排序</li>
<li>使用保留字DISTINCT对空值的处理，区分数据库的多种取值与现实中的多种取值的不同</li>
<li>使用GROUP BY对存在取空值的属性值进行分组</li>
<li>结合分组考察控制对各个集合函数的影响，特别注意对COUNT(*)和COUNT(列名)的不同影响</li>
<li>考察结果集市空集时，各个集函数的处理情况</li>
<li>验证嵌套查询中返回空集的情况下与各个谓词的运算结果</li>
<li>进行与空值有关的等值连接运算</li>
</ol>
<h3 id="实验步骤-5"><a href="#实验步骤-5" class="headerlink" title="实验步骤"></a>实验步骤</h3><p>(1)查询所有选课记录的成绩并将其转换为五分制(满分为5分，合格为3分)，注意SCORE取NULL的情况</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> score, score <span class="operator">/</span> <span class="number">20</span></span><br><span class="line"><span class="keyword">FROM</span> CHOICES;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210414093054.png" alt="image-20210414093054312"></p>
<p>(2)查询选修编号为10028的课程的学生的人数，其中成绩合格的的学生人数，不合格的学生人数，讨论NULL值的特殊含义</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> cid <span class="operator">=</span> <span class="string">&#x27;10028&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> cid <span class="operator">=</span> <span class="string">&#x27;10028&#x27;</span></span><br><span class="line">  <span class="keyword">AND</span> score <span class="operator">&gt;=</span> <span class="number">60</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> cid <span class="operator">=</span> <span class="string">&#x27;10028&#x27;</span></span><br><span class="line">  <span class="keyword">AND</span> score <span class="operator">&lt;</span> <span class="number">60</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(sid)</span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> cid <span class="operator">=</span> <span class="string">&#x27;10028&#x27;</span></span><br><span class="line">  <span class="keyword">AND</span> score <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line"><span class="comment">-- 选修了课程号为10028的学生总人数6042</span></span><br><span class="line"><span class="comment">-- 其中及格的人数为4812</span></span><br><span class="line"><span class="comment">-- 其中不及格的人数为755</span></span><br><span class="line"><span class="comment">-- 其中成绩为NULL的人数为475</span></span><br><span class="line"><span class="comment">-- 如果将成绩为NULL视为不及格，则查询语句应如下：</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(sid)</span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> cid <span class="operator">=</span> <span class="string">&#x27;10028&#x27;</span></span><br><span class="line">  <span class="keyword">AND</span> (score <span class="operator">&lt;</span> <span class="number">60</span></span><br><span class="line">    <span class="keyword">OR</span> score <span class="keyword">IS</span> <span class="keyword">NULL</span>);</span><br><span class="line"><span class="comment">-- 在CHOICES的定义中，score是可以取空值的，NULL&gt;=60和NULL&lt;60都不是TRUE</span></span><br></pre></td></tr></table></figure>

<p>(3)通过实验检验在使用ORDER BY进行排序时，取NULL的项是否出现在结果中？如果有，在什么位置</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> score</span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> cid <span class="operator">=</span> <span class="string">&#x27;10028&#x27;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> score;</span><br><span class="line"><span class="comment">-- 实际测试中，取值为NULL的项会出现在结果中，升序(ASC)排序时在开头，降序(DESC)排序时在末尾</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210414093118.png" alt="image-20210414093118323"></p>
<p>(4)在上面的查询的过程中如果加上保留字DISTINCT会有什么效果呢</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> score</span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> cid <span class="operator">=</span> <span class="string">&#x27;10028&#x27;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> score;</span><br><span class="line"><span class="comment">-- 使用DISTINCT时，若查询项仅有一项，那么所有的NULL会被视为相同的值</span></span><br><span class="line"><span class="comment">-- 比如SELECT score时会罗列所有的NULL，而SELECT DISTINCT score仅罗列一个NULL</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210414093152.png" alt="image-20210414093152686"></p>
<p>(5)通过实验说明使用分组GROUP BY对取值为NULL的项的处理</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> score, <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> cid <span class="operator">=</span> <span class="string">&#x27;10028&#x27;</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> score</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> score;</span><br><span class="line"><span class="comment">-- 可知GROUP BY中取NULL的被视为一个分组</span></span><br></pre></td></tr></table></figure>

<p>(6)结合分组，使用集合函数求每个同学的平均分，总的选课记录，最高成绩，最低成绩，总成绩</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sid,</span><br><span class="line">       <span class="built_in">AVG</span>(score) <span class="string">&#x27;AVG-SCORE&#x27;</span>,</span><br><span class="line">       <span class="built_in">COUNT</span>(cid) <span class="string">&#x27;COUNT-COURSE&#x27;</span>,</span><br><span class="line">       <span class="built_in">MAX</span>(score) <span class="string">&#x27;MAX-SCORE&#x27;</span>,</span><br><span class="line">       <span class="built_in">MIN</span>(score) <span class="string">&#x27;MIN-SCORE&#x27;</span>,</span><br><span class="line">       <span class="built_in">SUM</span>(score) <span class="string">&#x27;SUM-SCORE&#x27;</span></span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> sid</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">SUM</span>(score);</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210414093516.png" alt="image-20210414093434674"></p>
<p>(7)查询成绩小于0的选课记录，统计总数，平均分，最大值和最小值</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)   <span class="string">&#x27;COUNT-RECORD&#x27;</span>,</span><br><span class="line">       <span class="built_in">AVG</span>(score) <span class="string">&#x27;AVG-RECORD&#x27;</span>,</span><br><span class="line">       <span class="built_in">MAX</span>(score) <span class="string">&#x27;MAX-RECORD&#x27;</span>,</span><br><span class="line">       <span class="built_in">MIN</span>(score) <span class="string">&#x27;MIN-RECORD&#x27;</span></span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">WHERE</span> score <span class="operator">&lt;</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210414093928.png" alt="image-20210414093927972"></p>
<p>(8)采用嵌套查询的方式，利用比较运算符合谓词ALL的结合来查询表COURSES中最少的课时。<br>– 假设数据库中只有一个记录时，使用前面的方法会得到什么结果，为什么？</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">-- (1)自己的想法</span></span><br><span class="line"><span class="comment">-- 数据库中只有一个记录时，若这个记录的hour不为空，则展示这个记录的hour；若hour为空，则返回空集</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">hour</span></span><br><span class="line"><span class="keyword">FROM</span> COURSES</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">hour</span> <span class="operator">&lt;=</span> <span class="keyword">ALL</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">hour</span></span><br><span class="line">    <span class="keyword">FROM</span> COURSES</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- (2)书上的示例</span></span><br><span class="line"><span class="comment">-- 当只有一个记录时，逻辑上来说怎么都返回空集，但是DBS做了特殊处理？</span></span><br><span class="line"><span class="comment">-- hour值不为NULL时会返回这个记录；hour值为NULL时返回空集</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">hour</span></span><br><span class="line"><span class="keyword">FROM</span> COURSES C1</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">hour</span> <span class="operator">&lt;=</span> <span class="keyword">ALL</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">hour</span></span><br><span class="line">    <span class="keyword">FROM</span> COURSES C2</span><br><span class="line">    <span class="keyword">WHERE</span> C1.cid <span class="operator">!=</span> C2.cid</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 建立一个只有一个记录的表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> C_TEMP</span><br><span class="line">(</span><br><span class="line">    CID  <span class="type">CHAR</span>(<span class="number">10</span>) <span class="keyword">PRIMARY</span> <span class="keyword">KEY</span> <span class="keyword">UNIQUE</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    <span class="keyword">HOUR</span> <span class="type">SMALLINT</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> C_TEMP(CID, <span class="keyword">HOUR</span>)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;10001&#x27;</span>, <span class="keyword">NULL</span>);</span><br><span class="line"><span class="keyword">DELETE</span></span><br><span class="line"><span class="keyword">FROM</span> C_TEMP</span><br><span class="line"><span class="keyword">WHERE</span> CID <span class="operator">=</span> <span class="string">&#x27;10001&#x27;</span>;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> C_TEMP(CID, <span class="keyword">HOUR</span>)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;10001&#x27;</span>, <span class="number">10</span>);</span><br><span class="line"><span class="comment">-- (1)自己的思路</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> C_TEMP</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">HOUR</span> <span class="operator">&lt;=</span> <span class="keyword">ALL</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">HOUR</span></span><br><span class="line">    <span class="keyword">FROM</span> C_TEMP C2</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- (2)书上的示例</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> C_TEMP C1</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">HOUR</span> <span class="operator">&lt;=</span> <span class="keyword">ALL</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">HOUR</span></span><br><span class="line">    <span class="keyword">FROM</span> C_TEMP C2</span><br><span class="line">    <span class="keyword">WHERE</span> C1.CID <span class="operator">!=</span> C2.CID</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>(9)创建一个学生表S(NO, SID, SNAME)，教师表T(NO, TID, TNAME)作为实验用的表<br>– 其中，NO分别是这两个表的主键，其他键允许为空；NO为整型，其他字段为字符串型<br>– 向S中插入元组(1, ‘0129871001’, ‘王小明’),(2, ‘0129871002’, ‘李兰’),(3, ‘0129871005’, NULL),(4, ‘0129871004’, ‘关红’)<br>– 向T中插入元组(1, ‘100189’, ‘王小明’),(2, ‘100180’, 李小),(3, ‘100121’, NULL),(4, ‘100128’, NULL)<br>– 对这两个表作对姓名的等值连接运算，找出既是老师又是学生的人员的学生编号和教师编号</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> S</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">NO</span>    <span class="type">INT</span> <span class="keyword">PRIMARY</span> <span class="keyword">KEY</span>,</span><br><span class="line">    SID   <span class="type">CHAR</span>(<span class="number">10</span>),</span><br><span class="line">    SNAME <span class="type">CHAR</span>(<span class="number">10</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> T</span><br><span class="line">(</span><br><span class="line">    <span class="keyword">NO</span>    <span class="type">INT</span> <span class="keyword">PRIMARY</span> <span class="keyword">KEY</span>,</span><br><span class="line">    TID   <span class="type">CHAR</span>(<span class="number">10</span>),</span><br><span class="line">    TNAME <span class="type">CHAR</span>(<span class="number">10</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> S(<span class="keyword">NO</span>, SID, SNAME)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;0129871001&#x27;</span>, N<span class="string">&#x27;王小明&#x27;</span>),</span><br><span class="line">       (<span class="number">2</span>, <span class="string">&#x27;0129871002&#x27;</span>, N<span class="string">&#x27;李兰&#x27;</span>),</span><br><span class="line">       (<span class="number">3</span>, <span class="string">&#x27;0129871005&#x27;</span>, <span class="keyword">NULL</span>),</span><br><span class="line">       (<span class="number">4</span>, <span class="string">&#x27;0129871004&#x27;</span>, N<span class="string">&#x27;关红&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> T(<span class="keyword">NO</span>, TID, TNAME)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;100189&#x27;</span>, N<span class="string">&#x27;王小明&#x27;</span>),</span><br><span class="line">       (<span class="number">2</span>, <span class="string">&#x27;100180&#x27;</span>, N<span class="string">&#x27;李小&#x27;</span>),</span><br><span class="line">       (<span class="number">3</span>, <span class="string">&#x27;100121&#x27;</span>, <span class="keyword">NULL</span>),</span><br><span class="line">       (<span class="number">4</span>, <span class="string">&#x27;100128&#x27;</span>, <span class="keyword">NULL</span>);</span><br><span class="line"><span class="keyword">SELECT</span> SNAME, SID, TID</span><br><span class="line"><span class="keyword">FROM</span> S,</span><br><span class="line">     T</span><br><span class="line"><span class="keyword">WHERE</span> S.SNAME <span class="operator">=</span> T.TNAME;</span><br><span class="line"><span class="comment">-- 等值连接使用的运算符是等号，NULL不得TRUE</span></span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/leok77/blog-img-leok77/raw/main/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/20210414094131.png" alt="image-20210414094131014"></p>
<h3 id="自我实践-5"><a href="#自我实践-5" class="headerlink" title="自我实践"></a>自我实践</h3><p>(1)查询所有课程记录的上课学时(数据库中为每星期学时)，以一个学期十八个星期计算每个课程的总学时，注意HOUR取NULL值的情况</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cid, <span class="keyword">hour</span> <span class="operator">*</span> <span class="number">18</span> <span class="string">&#x27;ALL-HOUR&#x27;</span>, <span class="keyword">hour</span></span><br><span class="line"><span class="keyword">FROM</span> COURSES;</span><br></pre></td></tr></table></figure>

<p>(2)通过查询选修课程C++的学生的人数，其中成绩合格的学生人数，不合格的学生人数，讨论NULL值的特殊含义</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line"><span class="keyword">FROM</span> CHOICES,</span><br><span class="line">     COURSES</span><br><span class="line"><span class="keyword">WHERE</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">  <span class="keyword">AND</span> cname <span class="operator">=</span> <span class="string">&#x27;C++&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line"><span class="keyword">FROM</span> CHOICES,</span><br><span class="line">     COURSES</span><br><span class="line"><span class="keyword">WHERE</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">  <span class="keyword">AND</span> cname <span class="operator">=</span> <span class="string">&#x27;C++&#x27;</span></span><br><span class="line">  <span class="keyword">AND</span> score <span class="operator">&gt;=</span> <span class="number">60</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line"><span class="keyword">FROM</span> CHOICES,</span><br><span class="line">     COURSES</span><br><span class="line"><span class="keyword">WHERE</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">  <span class="keyword">AND</span> cname <span class="operator">=</span> <span class="string">&#x27;C++&#x27;</span></span><br><span class="line">  <span class="keyword">AND</span> score <span class="operator">&lt;</span> <span class="number">60</span>;</span><br></pre></td></tr></table></figure>

<p>(3)查询选修课程C++的学生的编号和成绩，使用ORDER BY按成绩进行排序时，取NULL的项是否出现在结果中？如果有，在什么位置？</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sid, score</span><br><span class="line"><span class="keyword">FROM</span> CHOICES,</span><br><span class="line">     COURSES</span><br><span class="line"><span class="keyword">WHERE</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">  <span class="keyword">AND</span> cname <span class="operator">=</span> <span class="string">&#x27;C++&#x27;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> score;</span><br><span class="line"><span class="comment">-- 会出现，视为最小值，升序开头，降序结尾</span></span><br></pre></td></tr></table></figure>

<p>(4)在上面的查询的过程中，如果加上保留字DISTINCT会有什么效果呢？</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sid, score</span><br><span class="line"><span class="keyword">FROM</span> CHOICES,</span><br><span class="line">     COURSES</span><br><span class="line"><span class="keyword">WHERE</span> CHOICES.cid <span class="operator">=</span> COURSES.cid</span><br><span class="line">  <span class="keyword">AND</span> cname <span class="operator">=</span> <span class="string">&#x27;C++&#x27;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> score;</span><br><span class="line"><span class="comment">-- 由于查询的是“编号和成绩”，而不是单独的成绩，当且仅当两个元组的“编号”和“成绩”都相同(两个NULL视为相同)时，才会发生变化</span></span><br></pre></td></tr></table></figure>

<p>(5)按年级对所有的学生进行分组，能得到多少个组？与现实的情况有什么不同</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> grade, <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="string">&#x27;COUNT-PEOPLE&#x27;</span></span><br><span class="line"><span class="keyword">FROM</span> STUDENTS</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> grade;</span><br><span class="line"><span class="comment">-- 能得到15个组，NULL的被视为了一组</span></span><br></pre></td></tr></table></figure>

<p>(6)结合分组，使用集合函数求每个课程选修的学生的平均分，总的选课记录数，最高成绩，最低成绩，讨论考察取空值的项对集合函数的作用的影响</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cid,</span><br><span class="line">       <span class="built_in">AVG</span>(score) <span class="string">&#x27;AVG-SCORE&#x27;</span>,</span><br><span class="line">       <span class="built_in">COUNT</span>(<span class="operator">*</span>)   <span class="string">&#x27;COUNT-PEOPLE&#x27;</span>,</span><br><span class="line">       <span class="built_in">MAX</span>(score) <span class="string">&#x27;MAX-SCORE&#x27;</span>,</span><br><span class="line">       <span class="built_in">MIN</span>(score) <span class="string">&#x27;MIN-SCORE&#x27;</span></span><br><span class="line"><span class="keyword">FROM</span> CHOICES</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> cid;</span><br></pre></td></tr></table></figure>

<p>(7)采用嵌套查询的方式，利用比较运算符和谓词ALL的结合来查询表STUDENTS中最晚入学的学生年级。<br>– 当存在GRADE取空值的项时，考虑可能出现的情况，并解释原因</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> grade</span><br><span class="line"><span class="keyword">FROM</span> STUDENTS</span><br><span class="line"><span class="keyword">WHERE</span> grade <span class="operator">&gt;=</span> <span class="keyword">ALL</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> grade</span><br><span class="line">    <span class="keyword">FROM</span> STUDENTS</span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 由于GRADE中存在空值，所以ALL中包含空值，任何一个grade&gt;=ALL都无法得到TRUE，所以得到的结果为空</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> grade</span><br><span class="line"><span class="keyword">FROM</span> STUDENTS</span><br><span class="line"><span class="keyword">WHERE</span> grade <span class="operator">&gt;=</span> <span class="keyword">ALL</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> grade</span><br><span class="line">    <span class="keyword">FROM</span> STUDENTS</span><br><span class="line">    <span class="keyword">WHERE</span> grade <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">-- 对子查询中进行IS NOT NULL约束之后得到最晚的年级——2004</span></span><br></pre></td></tr></table></figure>

<p>(8)将操作步骤中的表的数据进行更新，<br>– 使得表S中，NO为2和3的记录的SID列取NULL值，<br>– T表的NO为4的记录的TID取NULL值，NO为3的TID取0129871005<br>– 然后，对这两个表按T.TID=S.SID作等值连接运算，找出编号相同的学生和教师的姓名，并分析原因</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> S</span><br><span class="line"><span class="keyword">SET</span> SID<span class="operator">=</span><span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NO</span> <span class="keyword">IN</span> (<span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line"><span class="keyword">UPDATE</span> T</span><br><span class="line"><span class="keyword">SET</span> TID <span class="operator">=</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NO</span> <span class="operator">=</span> <span class="number">4</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> T</span><br><span class="line"><span class="keyword">SET</span> TID<span class="operator">=</span><span class="number">01298710005</span></span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NO</span> <span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line"><span class="keyword">SELECT</span> S.SID, SNAME, TNAME</span><br><span class="line"><span class="keyword">FROM</span> S,</span><br><span class="line">     T</span><br><span class="line"><span class="keyword">WHERE</span> S.SID <span class="operator">=</span> T.TID</span><br><span class="line"><span class="comment">-- 查询结果为空集，因为等值连接的运算符是等号，对于NULL=NULL来说取值不为TRUE</span></span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:17560376405@163.com">LeoK77</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://www.leok77.cn/2021/03/31/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C-%E7%AC%AC%E4%B8%80%E7%AB%A0-SQL%E8%AF%AD%E8%A8%80/">https://www.leok77.cn/2021/03/31/数据库系统/数据库系统实验-第一章-SQL语言/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.leok77.cn" target="_blank">LeoK77</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F/">数据库系统</a><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C/">数据库系统实验</a></div><div class="post_share"><div class="social-share" data-image="/img/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C%E6%8C%87%E5%AF%BC%E6%95%99%E7%A8%8B.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/04/01/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E4%BA%8C%E7%AB%A0-%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86/"><img class="prev-cover" src="/img/%E7%8E%8B%E9%81%93%E8%80%83%E7%A0%94-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">操作系统-第二章-进程管理</div></div></a></div><div class="next-post pull-right"><a href="/2021/03/28/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E7%AC%AC%E4%B8%80%E7%AB%A0-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0/"><img class="next-cover" src="/img/%E7%8E%8B%E9%81%93%E8%80%83%E7%A0%94-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">操作系统-第一章-计算机系统概述</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/04/07/数据库系统/数据库系统实验-第二章-数据库的完整性控制/" title="数据库系统实验-第二章-数据库的完整性控制"><img class="cover" src="/img/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C%E6%8C%87%E5%AF%BC%E6%95%99%E7%A8%8B.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-04-07</div><div class="title">数据库系统实验-第二章-数据库的完整性控制</div></div></a></div><div><a href="/2021/05/12/数据库系统/数据库系统实验-第三章-数据库的安全性控制/" title="数据库系统实验-第三章-数据库的安全性控制"><img class="cover" src="/img/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E5%AE%9E%E9%AA%8C%E6%8C%87%E5%AF%BC%E6%95%99%E7%A8%8B.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-05-12</div><div class="title">数据库系统实验-第三章-数据库的安全性控制</div></div></a></div><div><a href="/2021/04/30/数据库系统/LeetCode刷题记录-MSSQLSERVER/" title="数据库系统-LeetCode刷题记录-MSSQLSERVER"><img class="cover" src="/img/LeetCode_Logo.svg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-04-30</div><div class="title">数据库系统-LeetCode刷题记录-MSSQLSERVER</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">LeoK77</div><div class="author-info__description">考えたくはないよ  馬鹿になっていたいもん</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">17</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/leok77"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/leok77" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:17560376405@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEDataGrip"><span class="toc-number">1.</span> <span class="toc-text">配置DataGrip</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFDataGrip"><span class="toc-number">1.1.</span> <span class="toc-text">什么是DataGrip</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E5%90%AFSQL-Server%E7%9A%84TCP-IP%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.2.</span> <span class="toc-text">开启SQL Server的TCP&#x2F;IP协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DataGrip%E8%BF%9E%E6%8E%A5SQL-Server"><span class="toc-number">1.3.</span> <span class="toc-text">DataGrip连接SQL Server</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C1-1%E2%80%94%E2%80%94%E6%95%B0%E6%8D%AE%E5%AE%9A%E4%B9%89"><span class="toc-number">2.</span> <span class="toc-text">实验1.1——数据定义</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9"><span class="toc-number">2.1.</span> <span class="toc-text">实验内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E6%AD%A5%E9%AA%A4"><span class="toc-number">2.2.</span> <span class="toc-text">实验步骤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E6%88%91%E5%AE%9E%E8%B7%B5"><span class="toc-number">2.3.</span> <span class="toc-text">自我实践</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C1-2%E2%80%94%E2%80%94%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2"><span class="toc-number">3.</span> <span class="toc-text">实验1.2——数据查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E6%9C%9F%E5%87%86%E5%A4%87"><span class="toc-number">3.1.</span> <span class="toc-text">前期准备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9-1"><span class="toc-number">3.2.</span> <span class="toc-text">实验内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E6%AD%A5%E9%AA%A4-1"><span class="toc-number">3.3.</span> <span class="toc-text">实验步骤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E6%88%91%E5%AE%9E%E8%B7%B5-1"><span class="toc-number">3.4.</span> <span class="toc-text">自我实践</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C1-3%E2%80%94%E2%80%94%E6%95%B0%E6%8D%AE%E6%9B%B4%E6%96%B0"><span class="toc-number">4.</span> <span class="toc-text">实验1.3——数据更新</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9-2"><span class="toc-number">4.1.</span> <span class="toc-text">实验内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E6%AD%A5%E9%AA%A4-2"><span class="toc-number">4.2.</span> <span class="toc-text">实验步骤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E6%88%91%E5%AE%9E%E8%B7%B5-2"><span class="toc-number">4.3.</span> <span class="toc-text">自我实践</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C1-4%E2%80%94%E2%80%94%E8%A7%86%E5%9B%BE"><span class="toc-number">5.</span> <span class="toc-text">实验1.4——视图</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9-3"><span class="toc-number">5.1.</span> <span class="toc-text">实验内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E6%AD%A5%E9%AA%A4-3"><span class="toc-number">5.2.</span> <span class="toc-text">实验步骤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E6%88%91%E5%AE%9E%E8%B7%B5-3"><span class="toc-number">5.3.</span> <span class="toc-text">自我实践</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C1-5%E2%80%94%E2%80%94%E6%95%B0%E6%8D%AE%E6%8E%A7%E5%88%B6"><span class="toc-number">6.</span> <span class="toc-text">实验1.5——数据控制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9-4"><span class="toc-number">6.1.</span> <span class="toc-text">实验内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E6%AD%A5%E9%AA%A4-4"><span class="toc-number">6.2.</span> <span class="toc-text">实验步骤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E6%88%91%E5%AE%9E%E8%B7%B5-4"><span class="toc-number">6.3.</span> <span class="toc-text">自我实践</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C1-6%E2%80%94%E2%80%94%E7%A9%BA%E5%80%BC%E5%92%8C%E7%A9%BA%E9%9B%86%E7%9A%84%E5%A4%84%E7%90%86"><span class="toc-number">7.</span> <span class="toc-text">实验1.6——空值和空集的处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9-5"><span class="toc-number">7.1.</span> <span class="toc-text">实验内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E6%AD%A5%E9%AA%A4-5"><span class="toc-number">7.2.</span> <span class="toc-text">实验步骤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E6%88%91%E5%AE%9E%E8%B7%B5-5"><span class="toc-number">7.3.</span> <span class="toc-text">自我实践</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 By LeoK77</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk(Object.assign({
      clientID: '2f220532af9d5da3f585',
      clientSecret: '4dd9b398df123d0c1ddd42c6ed6a6122236053fb',
      repo: 'leok77.github.io',
      owner: 'leok77',
      admin: ['leok77'],
      id: '0499fb56879e534ce1a8ba8334f626a8',
      language: 'zh-CN',
      perPage: 10,
      distractionFreeMode: false,
      pagerDirection: 'last',
      createIssueManually: false,
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Gitalk' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script></div></body></html>